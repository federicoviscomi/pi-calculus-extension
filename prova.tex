% \chapter{$\pi$ calculus}

\section{Syntax}

\begin{definition}
  Let $\mathcal{N}$ be a countable set of names, ranged over by lower case letters $a,b, \cdots, z$. Furthermore we have a set of identifiers, ranged over by $A$. \emph{$\pi$ calculus} is the language generated by the following grammar:
  \begin{center}
    \begin{tabular}{l}
	$\pi$ ::= $\overline{x}y$ $\mid$ $x(y)$ $\mid$ $\tau$ 
      \\\\
	$P,Q$ ::= $0$ $\mid$ $\pi.P$ $\mid$ $P|Q$ $\mid$ $P+Q$ $\mid$ $(\nu x) P$ $\mid$ $A(\tilde{x})$ 
    \end{tabular}
  \end{center}
\end{definition}

\begin{definition}
  We say that the input prefix $x(y).P$ \emph{binds} $y$ in $P$ or is a \emph{binder} for $y$ in $P$. We also say that $P$ is the \emph{scope} of the binder and that any occurrence of $y$ in $P$ is \emph{bound} by the binder. Also the restriction operator in $(\nu y)P$ is a binder for $y$ in $P$. 
\end{definition}

\begin{definition}
  $bn(P)$ is the set of names that have a bound occurrence in $P$ and is defined as $B(P, \emptyset)$, where $B(P, I)$, with $I$ a set of identifiers, is defined in table \ref{table:B}
\end{definition}

  \begin{table}
    \begin{tabular}{l}
      \multicolumn{1}{l}{\line(1,0){415}}\\
	  $B(0, I) = \emptyset$
      \\
    \end{tabular}
    \\
    \begin{tabular}{ll}
      \\
	  $B(Q|R,I) = B(Q,I)\cup B(R,I)$
	&
	  $B(Q+R,I) = B(Q,I)\cup B(R,I)$
      \\
    \end{tabular}
    \\
    \begin{tabular}{lll}
      \\
	  $B(\overline{x}y.Q, I) = B(Q, I)$
	&
	  $B(\tau.Q, I) = B(Q, I)$
	&
	  $B(x(y).Q, I) = \{y,\overline{y}\}\cup B(Q, I)$
      \\
    \end{tabular}
    \\
    \begin{tabular}{l}
      \\
	  $B((\nu x)Q, I) = \{x, \overline{x}\}\cup B(Q, I)$
      \\\\
	$B(A(\tilde{y}), I)=\left\{
	  \begin{array}{ll}
		B(Q\{\tilde{y}/\tilde{x}\}, I\cup \{A\}) 
		where A(\tilde{x})\stackrel{def}{=}Q
	      &
		if A\notin I
	    \\
		\emptyset
	      &
		if A\in I
	  \end{array}\right.$
      \\\multicolumn{1}{l}{\line(1,0){415}}
    \end{tabular}
    \caption{Bound occurrences}
    \label{table:B}
  \end{table}



\begin{definition}
  We say that an occurrence of a name $x$ in $P$ is \emph{free} if it is not inside the scope of a binder for $x$. A name $x$ is free in $P$ if $P$ has a free occurrence of $x$. We write $fn(P)$ for the set of free names in $P$. $fn(P)$ is defined in table \ref{F}
\end{definition}

  \begin{table}
    \begin{tabular}{l}
	\multicolumn{1}{l}{\line(1,0){415}}
      \\
	  $fn(0) = \emptyset$
      \\
    \end{tabular}
    \\
    \begin{tabular}{ll}
      \\
	  $fn(Q+R) = fn(Q)\cup fn(R)$
	&
	  $fn(Q|R) = fn(Q)\cup fn(R)$
      \\
    \end{tabular}
    \\
    \begin{tabular}{lll}
      \\
	  $fn(x(y).Q) = \{x,\overline{x}\}\cup (fn(Q)-\{y,\overline{y}\})$
	&
	  $fn(\overline{x}y.Q) = \{x,\overline{x},y,\overline{y}\}\cup fn(Q)$
	&
	  $fn(\tau.Q) = fn(Q)$
      \\
    \end{tabular}
    \\
    \begin{tabular}{l}
      \\
	  $fn((\nu x)Q) = fn(Q)-\{x,\overline{x}\}$	  
      \\\\
	  $fn(A(\tilde{x}))=\{\tilde{x}\}$
      \\
	\multicolumn{1}{l}{\line(1,0){415}}
      \\
    \end{tabular}
    \caption{Free occurrences}
    \label{F}
  \end{table}



\begin{definition}
  $n(P)$ which is the set of all names in $P$ and is defined in the following way:
  \begin{center}
    $n(P) = fn(P)\cup bn(P)$
  \end{center}
\end{definition}


% \begin{definition}
%   We say that $\tau$ and actions which does not have any binder, i.e. $xy$ and $ \overline{x}y$, are \emph{free actions}. Whether other actions, i.e. $x(y)$ and $\overline{x}(y)$, are \emph{bound actions}.
% \end{definition}


In a definition $A(\tilde{x})=P$ the $\tilde{x}$ are exactly the free names contained in $P$, specifically $fn(P) = \{\tilde{x}\}$. If we look at the definitions of $bn$ and of $fn$ we notice that if $P$ contains another identifier whose definition is: $B(\tilde{z})=Q$ then we have $fn(Q)\subseteq\{\tilde{x}\}$.


\begin{definition}
  $P\{b/a\}$ is the syntactic substitution of name $b$ for a different name $a$ inside a $\pi$ calculus process and it consists in replacing every free occurrences of $a$ with $b$. If $b$ is a bound name in $P$, in order to avoid name capture we perform an appropriate change of bound names. $P\{b/a\}$ is defined in table \ref{syntacticsubstitution}. We use the notation $\{\tilde{x}/\tilde{y}\}$ as a short for $\{x_{1}/y_{1}, \cdots, x_{n}/y_{n}\}$, where $P\{x_{1}/y_{1}, \cdots, x_{n}/y_{n}\}$ means $((P\{x_{1}/y_{1}\})\{x_{2}/y_{2}\}) \cdots \{x_{n}/y_{n}\}$.
  \begin{table}
    \begin{tabular}{l}
      \multicolumn{1}{l}{\line(1,0){415}}\\
	$0\{b/a\} = 0$
      \\
    \end{tabular}
    \\
    \begin{tabular}{ll}
      \\
	$(\overline{x}y.Q)\{b/a\} = \overline{x}\{b/a\}y\{b/a\}.Q\{b/a\}$
      &
	$(\tau.Q)\{b/a\} = \tau.Q\{b/a\}$
      \\
    \end{tabular}
      \\
    \begin{tabular}{ll}
      \\
	$\inferrule{
	  y\neq a \\ y\neq b
	}{
	  (x(y).Q)\{b/a\} = x\{b/a\}(y).Q\{b/a\}
	}$
      &
	$(x(a).Q)\{b/a\} = x\{b/a\}(a).Q$
      \\\\
	$\inferrule{
	    c\notin n(x(b).Q)
	  \\
	    a\in fn(Q)
	}{
	  (x(b).Q)\{b/a\} = x\{b/a\}(c).((Q\{c/b\})\{b/a\})
	}$
      &
	$\inferrule{
	    a\notin fn(Q)
	}{
	  (x(b).Q)\{b/a\} = x\{b/a\}(b).Q)
	}$
    \\
    \end{tabular}
      \\
    \begin{tabular}{l}
    \\
	$A(\tilde{x})\{b/a\} = A(\tilde{x}\{b/a\})$
    \\
    \end{tabular}
      \\
    \begin{tabular}{ll}
      \\
	$(Q+R)\{b/a\} = Q\{b/a\} + R\{b/a\}$
      &
	$(Q|R)\{b/a\} = Q\{b/a\} | R\{b/a\}$
      \\
    \end{tabular}
      \\
    \begin{tabular}{ll}
      \\
	$\inferrule{y\neq a \\ y\neq b}{((\nu y)Q)\{b/a\} =(\nu y)Q\{b/a\}}$ 
      &
	$((\nu a)Q)\{b/a\} =(\nu a)Q$
      \\\\
	$\inferrule{c\notin n((\nu b)Q) \\ a\in fn(Q)}{((\nu b)Q)\{b/a\} =(\nu c)((Q\{c/b\})\{b/a\})}$ 
      &
	$\inferrule{a\notin fn(Q)}{((\nu b)Q)\{b/a\} =(\nu b)Q}$ 
      \\\multicolumn{2}{l}{\line(1,0){415}}
    \end{tabular}
    \caption{Syntatic substitution}
    \label{syntacticsubstitution}
  \end{table}

\end{definition}



\section{$\alpha$ conversion}
\begin{definition}
  Let $\sigma$ be a function of names. $\beta,\sigma$ equivalence is the smallest binary relation on processes that satisfies the laws in table \ref{betaequivalence}. In a process $P$ we can assume that all bound names are different. 
  \begin{table}
    \begin{tabular}{l}
      \multicolumn{1}{l}{\line(1,0){415}}\\\\
	  $\inferrule*[left=BetaOut]{
	      P\equiv_{\beta}^{\sigma}Q
	    \\
	      (x\sigma z) \vee (x,z \notin n(\sigma)) \vee (x \sigma x \wedge z \sigma z)
	    \\
	      (y\sigma w) \vee (y,w \notin n(\sigma)) \vee (y \sigma y \wedge w \sigma w)
	  }{
	      \overline{x}y.P\equiv_{\beta}\overline{z}w.Q
	    \\
	      \sigma \cup \{x\mapsto z\} \cup \{y\mapsto w\}
	  }$
	\\
      \end{tabular}
      \\
      \begin{tabular}{ll}
      \\
	  $\inferrule*[left=BetaTau]{
	      P\equiv_{\beta}Q
	    \\
	      \sigma
	  }{
	      \tau.P\equiv_{\beta}\tau.Q
	    \\
	      \sigma
	  }$
	&
	  $\inferrule*[left=BetaZero]{
	  }{
	      0\equiv_{\beta}0
	    \\
	      \emptyset
	  }$
    \\
    \end{tabular}
      \\
    \begin{tabular}{l}
    \\
	  $\inferrule*[left=BetaInp]{
	      P\equiv_{\beta}Q
	    \\
	      \sigma
	    \\
	      (y \sigma y) \vee (y\notin n(\sigma))
	    \\
	      (x\sigma z) \vee (x,z\notin n(\sigma)) \vee (x\sigma x \wedge z\sigma z)
	  }{
	      x(y).P\equiv_{\beta}z(y).Q
	    \\
	      \sigma \{x\mapsto z\}
	  }$
	\\\\
	  $\inferrule*[left=BetaRes]{
	      P\equiv_{\beta}Q
	    \\
	      \sigma
	    \\
	      (x \sigma x) \vee (x\notin n(\sigma))
	  }{
	      (\nu x)P\equiv_{\beta}(\nu x)Q
	    \\
	      \sigma
	  }$
      \\
    \end{tabular}
    \\
    \begin{tabular}{ll}
      \\
	  $\inferrule*[left=BetaIde]{
	  }{
	      A(\tilde{x})\equiv_{\beta}A(\tilde{x})
	    \\
	      \emptyset
	  }$
	&
	  $\inferrule*[left=BetaIde1]{
	    \tilde{x} \neq \tilde{y}
	  }{
	      A(\tilde{x})\equiv_{\beta}A(\tilde{y})
	    \\
	      \{x_{1}\mapsto y_{1}\}\cdot\{x_{n}\mapsto y_{n}\}
	  }$
      \\
    \end{tabular}
    \\
    \begin{tabular}{l}
      \\
	  $\inferrule*[left=BetaPar]{
	      P_{1}\equiv_{\beta}Q_{1}
	    \\
	      \sigma_{1}
	    \\
	      P_{2}\equiv_{\beta}Q_{2}
	    \\
	      \sigma_{2}
	    \\
	      (\sigma_{1}\subseteq \sigma_{2}) \vee (\sigma_{2}\subseteq \sigma_{1})
	  }{
	      P_{1}|P_{2}\equiv_{\beta}Q_{1}|Q_{2}
	    \\
	      \sigma_{1} \cup \sigma_{2}
	  }$
      \\\\
	  $\inferrule*[left=BetaSum]{
	      P_{1}\equiv_{\beta} Q_{1}
	    \\
	      \sigma_{1}
	    \\
	      P_{2}\equiv_{\beta} Q_{2}
	    \\
	      \sigma_{2}
	    \\
	      (\sigma_{1}\subseteq \sigma_{2}) \vee (\sigma_{2}\subseteq \sigma_{1})
	  }{
	      P_{1}+P_{2}\equiv_{\beta}Q_{1}+Q_{2}
	    \\
	      \sigma_{1} \cup \sigma_{2}
	  }$
      \\
    \end{tabular}
    \\
    \begin{tabular}{l}
      \\
	  $\inferrule*[left=BetaRes1]{
	      P\equiv_{\beta}Q
	    \\
	      \sigma
	    \\
	      (x\sigma y) \vee (x\sigma x \wedge y\sigma y) \vee (x,y\notin n(\sigma))
	    \\
	      x \neq y
	  }{
	      (\nu x)P\equiv_{\beta}(\nu y)Q
	    \\
	      \sigma - \{x\mapsto y\}
	  }$
      \\\\
	  $\inferrule*[left=BetaInp1]{
	      P\equiv_{\beta}Q
	    \\
	      \sigma
	    \\
	      (y\sigma w) \vee (y \sigma y \wedge w \sigma w) \vee (y,w\notin n(\sigma))
	    \\
	      y \neq w
	    \\
	      (x\sigma z) \vee (x\sigma x \wedge z\sigma z) \vee (x,z\notin n(\sigma))
	  }{
	      x(y).P\equiv_{\beta}z(w).Q
	    \\
	      (\sigma \{x\mapsto z\})- \{y\mapsto w\}
	  }$
    \\\\\multicolumn{1}{l}{\line(1,0){415}}
    \end{tabular}
    \caption{$\beta$ equivalence laws}
    \label{betaequivalence}
  \end{table}
\end{definition}

\begin{definition}
  Processes $P$ and $Q$ are \emph{$\alpha$ convertible} or \emph{$\alpha$ equivalent} if they are $\beta$ equivalent with respect to a substitution which is contained in the identity function on names.
\end{definition}


\begin{lemma}
  $\alpha$ equivalence is reflexive.
  \begin{proof}
    We prove that $P\equiv_{\beta}^{\emptyset} P$. The proof is a structural induction on $P$:
	\begin{center}
	  \begin{tabular}{ll}
	    $\inferrule*[left=BetaOut]{
		P\equiv_{\beta}P
	      \\
		\emptyset
	    }{
		\overline{x}y.P\equiv_{\beta}\overline{x}y.Q
	      \\
		\emptyset \{x\mapsto x\} \{y\mapsto y\}
	    }$
	  &
	    $\inferrule*[left=BetaTau]{
	      P\equiv_{\beta}Q
	    \\
	      \emptyset
	    }{
		\tau.P\equiv_{\beta}\tau.Q
	      \\
		\emptyset
	    }$
	\\\\
	  $\inferrule*[left=BetaInp]{
	      P\equiv_{\beta}Q
	    \\
	      \emptyset
	  }{
	      x(y).P\equiv_{\beta}x(y).Q
	    \\
	      \emptyset \{x\mapsto x\}
	  }$
	&
	  $\inferrule*[left=BetaRes]{
	      P\equiv_{\beta}Q
	    \\
	      \emptyset
	  }{
	      (\nu x)P\equiv_{\beta}(\nu x)Q
	    \\
	      \emptyset \{x\mapsto x\}
	  }$
      \\\\
	  $\inferrule*[left=BetaIde]{
	  }{
	      A(\tilde{x})\equiv_{\beta}A(\tilde{x})
	    \\
	      \emptyset
	  }$
	&
	  $\inferrule*[left=BetaZero]{
	  }{
	      0\equiv_{\beta}0
	    \\
	      \emptyset
	  }$
      \\
    \end{tabular}
    \\
    \begin{tabular}{l}
      \\
	  $\inferrule*[left=BetaPar]{
	      P_{1}\equiv_{\beta}Q_{1}
	    \\
	      \emptyset 
	    \\
	      P_{2}\equiv_{\beta}Q_{2}
	    \\
	      \emptyset
	  }{
	      P_{1}|P_{2}\equiv_{\beta}Q_{1}|Q_{2}
	    \\
	      \emptyset \cup \emptyset
	  }$
      \\\\
	  $\inferrule*[left=BetaSum]{
	      P_{1}\equiv_{\beta}Q_{1}
	    \\
	      \emptyset
	    \\
	      P_{2}\equiv_{\beta}Q_{2}
	    \\
	      \emptyset
	  }{
	      P_{1}+P_{2}\equiv_{\beta}Q_{1}+Q_{2}
	    \\
	      \emptyset \cup \emptyset
	  }$
	\\
	\end{tabular}
      \end{center}
  \end{proof}
\end{lemma}

\begin{lemma}
  $\alpha$ equivalence is symmetric.
  \begin{proof}
    We prove that $P\equiv_{\beta}^{\sigma}Q$ imply $Q\equiv_{\beta}^{\sigma^{-1}}P$ by induction on the rules:
    \begin{description}
      \item[$BetaOut$]:
	\begin{center}
	  $\inferrule*[left=BetaOut]{
	      P\equiv_{\beta}Q
	    \\
	      \sigma
	    \\
	      (x\sigma z) \vee (x\sigma x \wedge z\sigma z)
	    \\
	      (y\sigma w) \vee (y\sigma y \wedge w\sigma w)
	  }{
	      \overline{x}y.P\equiv_{\beta}\overline{z}w.Q
	    \\
	      \sigma \{x\mapsto z\} \{y\mapsto w\}
	  }$
	\end{center}
	for inductive hypothesis: $Q\equiv_{\beta}^{\sigma^{-1}} P$. $(x\sigma z) \vee (x\sigma x \wedge z\sigma z)$ imply $(z\sigma^{-1} x) \vee (x\sigma^{-1} x \wedge z\sigma^{-1} z)$. $(y\sigma w) \vee (y\sigma y \wedge w\sigma w)$ imply $(w\sigma^{-1} y) \vee (y\sigma^{-1} y \wedge w\sigma^{-1} w)$. And rule $BetaOut$ imply $\overline{z}w.Q\equiv_{\beta}\overline{x}y.P$ with respect to $\sigma^{-1} \{z\mapsto x\} \{w\mapsto y\}$.
      \item[$BetaTau$]:
	\begin{center}
	  $\inferrule*[left=BetaTau]{
	      P\equiv_{\beta}Q
	    \\
	      \sigma
	  }{
	      \tau.P\equiv_{\beta}\tau.Q
	    \\
	      \sigma
	  }$
	\end{center}
	for inductive hypothesis $Q\equiv_{\beta}^{\sigma^{-1}}P$ and for rule $BetaTau$: $\tau.Q\equiv_{\beta}\tau.P$.
      \item[$BetaInp$]:
	\begin{center}
	  $\inferrule*[left=BetaInp]{
	      P\equiv_{\beta}Q
	    \\
	      \sigma
	    \\
	      y \sigma y
	    \\
	      (x\sigma z) \vee (x\sigma x \wedge z\sigma z)
	  }{
	      x(y).P\equiv_{\beta}z(y).Q
	    \\
	      \sigma \{x\mapsto z\}
	  }$	  
	\end{center}
	for inductive hypothesis $Q\equiv_{\beta}^{\sigma^{-1}}P$. $(x\sigma z) \vee (x\sigma x \wedge z\sigma z)$ imply $(z\sigma^{-1} x) \vee (x\sigma^{-1} x \wedge z\sigma^{-1} z)$. And rule $BetaInp$ imply $z(y).Q\equiv_{\beta} x(y).P$ with respect to $\sigma^{-1} \{z\mapsto x\}$.
      \item[$BetaRes$]:
	\begin{center}
	  $\inferrule*[left=BetaRes]{
	      P\equiv_{\beta}Q
	    \\
	      \sigma
	    \\
	      x \sigma x
	  }{
	      (\nu x)P\equiv_{\beta}(\nu x)Q
	    \\
	      \sigma
	  }$	  
	\end{center}
	for inductive hypothesis $Q\equiv_{\beta}^{\sigma^{-1}}P$. $x \sigma x$ imply $x \sigma^{-1} x$. For rule $BetaRes$: $(\nu x)Q\equiv_{\beta}^{\sigma^{-1}}(\nu x)P$
      \item[$BetaIde, BetaZero, BetaIde1$] it easy to see that the lemma holds in these cases
	
    \end{description}
DA CONTINUARE
    \begin{tabular}{l}
      \\
	  $\inferrule*[left=BetaPar]{
	      P_{1}\equiv_{\beta}Q_{1}
	    \\
	      \sigma_{1}
	    \\
	      P_{2}\equiv_{\beta}Q_{2}
	    \\
	      \sigma_{2}
	    \\
	      (\sigma_{1}\subseteq \sigma_{2}) \vee (\sigma_{2}\subseteq \sigma_{1})
	  }{
	      P_{1}|P_{2}\equiv_{\beta}Q_{1}|Q_{2}
	    \\
	      \sigma_{1} \cup \sigma_{2}
	  }$
      \\\\
	  $\inferrule*[left=BetaSum]{
	      P_{1}\equiv_{\beta} Q_{1}
	    \\
	      \sigma_{1}
	    \\
	      P_{2}\equiv_{\beta} Q_{2}
	    \\
	      \sigma_{2}
	    \\
	      (\sigma_{1}\subseteq \sigma_{2}) \vee (\sigma_{2}\subseteq \sigma_{1})
	  }{
	      P_{1}+P_{2}\equiv_{\beta}Q_{1}+Q_{2}
	    \\
	      \sigma_{1} \cup \sigma_{2}
	  }$
      \\
    \end{tabular}
    \\
    \begin{tabular}{l}
      \\
	  $\inferrule*[left=BetaRes1]{
	      P\equiv_{\beta}Q
	    \\
	      \sigma
	    \\
	      (x\sigma y) \vee (x\sigma x \wedge y\sigma y)
	    \\
	      x \neq y
	  }{
	      (\nu x)P\equiv_{\beta}(\nu y)Q
	    \\
	      \sigma - \{x\mapsto y\}
	  }$
      \\\\
	  $\inferrule*[left=BetaInp1]{
	      P\equiv_{\beta}Q
	    \\
	      \sigma
	    \\
	      (y\sigma w) \vee (y \sigma y \wedge w \sigma w)
	    \\
	      y \neq w
	    \\
	      (x\sigma z) \vee (x\sigma x \wedge z\sigma z)
	  }{
	      x(y).P\equiv_{\beta}z(w).Q
	    \\
	      (\sigma \{x\mapsto z\})- \{y\mapsto w\}
	  }$
    \\
    \end{tabular}    
  \end{proof}
\end{lemma}

\begin{lemma}
  $P\equiv_{\beta}^{\sigma}Q$ and $x\in fn(P)$ then one and only one of the following case holds: 
  \begin{itemize}
    \item 
      $x\in fn(Q)$ and $(x\sigma x \vee x\notin n(\sigma))$ 
    \item
      $x\notin fn(Q)$ and there exists $y$ such that $y\in fn(Q)$ and $x\sigma y$
  \end{itemize}
\end{lemma}

\begin{lemma}
  $P\equiv_{\beta}^{\sigma}Q$ and $x\sigma y$ imply $x\in fn(P)$ and $y\in fn(Q)$
\end{lemma}



\begin{lemma}
  If $P\equiv_{\beta}^{\sigma_{1}} Q$ and $Q\equiv_{\beta}^{\sigma_{2}} R$ then $P \equiv_{\beta}^{\sigma_{3}} R$ and $\sigma_{3}= \sigma_{1} \cdot \sigma_{2}$.
  \begin{proof}
    We have to prove that $P\equiv_{\beta}^{\sigma_{3}} R$. We go by induction on the derivation of both $P\equiv_{\beta}^{\sigma_{1}} Q$ and $Q\equiv_{\beta}^{\sigma_{2}} R$:
    \begin{description}
      \item[$(BetaIde, BetaIde)$]:
	In this case $P$, $Q$ and $R$ are some identifier $A(\tilde{x})$ and $\sigma_{1}=\sigma_{2}=\sigma_{3}=\emptyset$.
      \item[$(BetaZero, BetaZero)$]
	in this case $P$, $Q$ and $R$ are $0$ and $\sigma_{1}=\sigma_{2}=\sigma_{3}=\emptyset$.
      \item[$(BetaTau, BetaTau)$]:
	\begin{center}
	  \begin{tabular}{ll}
	      $\inferrule*[left=BetaTau]{
		  P \equiv_{\beta} Q
		\\
		   \sigma_{1}
	      }{
		  \tau.P \equiv_{\beta} \tau.Q
		\\
		  \sigma_{1}
	      }$	      
	    &
	      $\inferrule*[left=BetaTau]{
		  Q \equiv_{\beta} R
		\\
		  \sigma_{2}
	      }{
		  \tau.Q \equiv_{\beta} \tau.R
		\\
		  \sigma_{2}
	      }$
	  \end{tabular}
	\end{center}
	for inductive hypothesis $P\equiv_{\beta}^{\sigma_{3}} R$ and $\sigma_{3}=\sigma_{1}\cdot \sigma_{2}$. For rule $BetaTau$: $\tau.P\equiv_{\beta}^{\sigma_{3}} \tau.R$
      \item[$(BetaSum, BetaSum)$]
      \item[$(BetaPar, BetaPar)$]
      \item[$(BetaRes, BetaRes)$]
      \item[$(BetaInp, BetaInp)$]
      \item[$(BetaRes1, BetaRes1)(1)$]:
	\begin{center}
	  \begin{tabular}{l}
	      $\inferrule*[left=BetaRes1]{
		  P \equiv_{\beta} Q
		\\
		  \sigma_{1}
		\\
		  (x\sigma_{1}y) \vee (x\sigma_{1}x \wedge y\sigma_{1}y)
		\\
		  x \neq y
	      }{
		  (\nu x)P \equiv_{\beta} (\nu y)Q
		\\
		  \sigma_{1} - (xy)
	      }$	      
	    \\\\
	      $\inferrule*[left=BetaRes1]{
		  Q \equiv_{\beta}^{\sigma_{2}} R
		\\
		  \sigma_{2}
		\\
		  (y\sigma_{2}z) \vee (y\sigma_{2}y \wedge z\sigma_{2}z)
		\\
		  y \neq z
	      }{
		  (\nu y)Q \equiv_{\beta} (\nu z)R
		\\
		  \sigma_{2} - (yz)
	      }$
	  \end{tabular}
	\end{center}
	there can only happen two cases:
	\begin{itemize}
	  \item 
	    $(x\sigma_{1}y)$ and $(y\sigma_{2}z)$
	  \item
	    or $(x\sigma_{1}x \wedge y\sigma_{1}y)$ and $(y\sigma_{2}y \wedge z\sigma_{2}z)$
	\end{itemize}
	in both cases we can apply the inductive hypothesis and get $P\equiv_{\beta}^{\sigma_{3}} R$ and $\sigma_{3} = \sigma_{1} \cdot \sigma_{2}$. Then the conclusion follows for rule $BetaRes1$.
      \item[$(BetaRes1, BetaRes)$]
      \item[$(BetaRes, BetaRes1)$]:
      \item[$(BetaInp1, BetaInp1)$]
    \end{description}
  \end{proof}
\end{lemma}

\begin{corollary}
  $\alpha$ equivalence is transitive.
\end{corollary}

\begin{proposition}
  $\alpha$ equivalence is an equivalence relation.
\end{proposition}


\begin{lemma}
  $P\equiv_{\alpha}Q$ and $x\notin bn(P,Q)$ imply $P\{x/y\} \equiv_{\alpha} Q\{x/y\}$.
  \begin{proof}
    We prove that $P\equiv_{\beta}^{\sigma}Q$ and $x\notin bn(P,Q)$ imply $P\{x/y\} \equiv_{\beta}^{\sigma^{'}} Q\{x/y\}$ where $\sigma^{'}$ is such that:
    $\{a\mapsto b\} \in \sigma$ imply $\{a\{x/y\}\mapsto b\{x/y\}\} \in \sigma^{'}$. Then the conclusion follows because if $\sigma\subseteq id$ then also $\sigma^{'}\subseteq id$.
  \end{proof}
\end{lemma}


\begin{lemma}
  $P\equiv_{\alpha}Q$ imply $P\{x/y\} \equiv_{\alpha} Q\{x/y\}$.
  \begin{proof}
    We prove that $P\equiv_{\beta}^{\sigma}Q$ imply $P\{x/y\} \equiv_{\beta}^{\sigma^{'}} Q\{x/y\}$ where $\sigma^{'}$ is such that:
    $\{a\mapsto b\} \in \sigma$ imply $\{a\{x/y\}\mapsto b\{x/y\}\} \in \sigma^{'}$. Then the conclusion follows because if $\sigma\subseteq id$ then also $\sigma^{'}\subseteq id$.
  \end{proof}
\end{lemma}


\section{Early semantic with explicit $\alpha$ conversion}

\begin{definition}
  The \emph{early transition relation with $\alpha$ conversion} $\rightarrow$ is the smallest relation induced by the rules in table \ref{transitionrelationearlywithalphaconversion}.

  \begin{table}
    \begin{tabular}{lll}  
      	\multicolumn{3}{l}{\line(1,0){415}}\\\\
	  $\inferrule* [left=\bf{Out}]{
	  }{
	    \overline{x}y.P \xrightarrow{\overline{x}y} P
	  }$
	&
	  $\inferrule* [left=\bf{EInp}]{
	  }{
	    x(y).P \xrightarrow{xz} P\{z/y\}
	  }$
	&
	  $\inferrule* [left=\bf{Tau}]{
	  }{
	    \tau.P \xrightarrow{\tau} P
	  }$
      \\
    \end{tabular}
    \\
    \begin{tabular}{ll}  
      \\
	  $\inferrule* [left=\bf{ParL}]{
	      P \xrightarrow{\alpha} P^{'}
	    \\
	      bn(\alpha)\cap fn(Q)=\emptyset
	  }{
	    P|Q \xrightarrow{\alpha} P^{'}|Q
	  }$
	&
	  $\inferrule* [left=\bf{ParR}]{
	      Q \xrightarrow{\alpha} Q^{'}
	    \\
	      bn(\alpha)\cap fn(P)=\emptyset
	  }{
	    P|Q \xrightarrow{\alpha} P|Q^{'}
	  }$
      \\\\
	  $\inferrule* [left=\bf{SumL}]{
	      P \xrightarrow{\alpha} P^{'}
	    \\
	      bn(\alpha)\cap fn(Q)=\emptyset
	  }{
	    P+Q \xrightarrow{\alpha} P^{'}
	  }$
	&
	  $\inferrule* [left=\bf{SumR}]{
	      Q \xrightarrow{\alpha} Q^{'}
	    \\
	      bn(\alpha)\cap fn(P)=\emptyset
	  }{
	    P+Q \xrightarrow{\alpha} Q^{'}
	  }$
      \\\\
	  $\inferrule* [left=\bf{Res}]{
	      P \xrightarrow{\alpha} P^{'}
	    \\
	      z\notin n(\alpha)
	  }{
	    (\nu z) P \xrightarrow{\alpha} (\nu z) P^{'}
	  }$
	&
	  $\inferrule* [left=\bf{Alp}]{
	      P\equiv_{\alpha}Q
	    \\
	      P\xrightarrow{\alpha}P^{'}
	  }{
	    Q\xrightarrow{\alpha}P^{'}
	  }$
      \\\\
	  $\inferrule* [left=\bf{EComL}]{
	      P \xrightarrow{xy} P^{'}
	    \\
	      Q\xrightarrow{\overline{x}y} Q^{'}
	  }{
	    P|Q \xrightarrow{\tau} P^{'}|Q^{'}
	  }$
	&
	  $\inferrule* [left=\bf{EComR}]{
	      P \xrightarrow{\overline{x}y} P^{'}
	    \\
	      Q\xrightarrow{xy} Q^{'}
	  }{
	    P|Q \xrightarrow{\tau} P^{'}|Q^{'}
	  }$
      \\\\
	  $\inferrule* [left=\bf{ClsL}]{
	      P \xrightarrow{\overline{x}(z)} P^{'}
	    \\
	      Q \xrightarrow{xz} Q^{'}
	    \\
	      z\notin fn(Q)
	  }{
	    P|Q \xrightarrow{\tau} (\nu z)(P^{'}|Q^{'})
	  }$
	&
	  $\inferrule* [left=\bf{ClsR}]{
	      P \xrightarrow{xz} P^{'}
	    \\
	      Q \xrightarrow{\overline{x}(z)} Q^{'}
	    \\
	      z\notin fn(P)
	  }{
	    P|Q \xrightarrow{\tau} (\nu z)(P^{'}|Q^{'})
	  }$
      \\\\
	  $\inferrule* [left=\bf{Ide}]{
	      A(\tilde{x}) \stackrel{def}{=} P
	    \\
	      P\{\tilde{w}/\tilde{x}\} \xrightarrow{\alpha} P^{'}
	  }{
	    A(\tilde{w}) \xrightarrow{\alpha} P^{'}
	  }$
	&
	  $\inferrule* [left=\bf{Opn}]{
	      P \xrightarrow{\overline{x}z} P^{'}
	    \\
	      z\neq x
	  }{
	    (\nu w) P \xrightarrow{\overline{x}(w)} P^{'}\{w/z\}
	  }$
      \\	\multicolumn{2}{l}{\line(1,0){415}}
    \end{tabular}
    \caption{Early transition relation with $\alpha$ conversion but without structural congruence}
    \label{transitionrelationearlywithalphaconversion}
  \end{table}
\end{definition}



\section{Properties of the semantic}
In the following $\rightarrow_{2}$ is the $\pi$ calculus early semantics without structural congruence but with explicit $\alpha$ conversion. Whether $\twoheadrightarrow_{2}$ is the same of $\rightarrow_{2}$ but without rule $Alp$.

\begin{lemma}
  If $P\xrightarrow{\lambda}_{2} P^{'}$ then $P\equiv_{\alpha} Q$, $Q\stackrel{\lambda}{\twoheadrightarrow}_{2} Q^{'}$ and $P^{'}\equiv_{\alpha} Q^{'}$
\end{lemma}




\begin{lemma}
  If $P\equiv_{\alpha} Q$ and $Q\stackrel{\lambda}{\twoheadrightarrow}_{2} Q^{'}$ then $P\stackrel{\lambda}{\twoheadrightarrow}_{2} P^{'}$ and $P^{'}\equiv_{\alpha} Q^{'}$.
  \begin{proof}
    The proof is an induction on both the derivation of $P\equiv_{\beta}^{\sigma} Q$ and $Q\stackrel{\lambda}{\twoheadrightarrow}_{2} Q^{'}$. The last pair of rules used can be:
    \begin{description}
      \item[$(BetaIde, Ide)$]:
	\begin{center}
	  \begin{tabular}{ll}
	      $\inferrule*[left=BetaIde]{
	      }{
		  A(\tilde{y})\equiv_{\beta}A(\tilde{y})
		\\
		  \emptyset
	      }$	      
	    &
	      $\inferrule*[left=Ide]{
		  A(\tilde{x}) \stackrel{def}{=} P
		\\
		  P\{\tilde{y}/\tilde{x}\} \stackrel{\lambda}{\twoheadrightarrow}_{2} P^{'}
	      }{
		  A(\tilde{y}) \stackrel{\lambda}{\twoheadrightarrow}_{2} P^{'}
	      }$	      
	  \\
	  \end{tabular}
	\end{center}
      \item[$(BetaInp, EInp)$]:
	\begin{center}
	  \begin{tabular}{l}
	      $\inferrule*[left=BetaInp]{
		  P\equiv_{\beta}^{\sigma}Q
		\\
		  (y \sigma y) \vee (y\notin n(\sigma))
		\\
		  (x \sigma x) \vee (x\notin n(\sigma))
	      }{
		  x(y).P\equiv_{\beta}x(y).Q
		\\
		  \sigma \{x\mapsto x\}
	      }$
	    \\
	      $\inferrule*[left=EInp]{
	      }{
		  x(y).Q \stackrel{xw}{\longtwoheadrightarrow}_{2} Q\{w/y\}
	      }$	      
	  \\
	  \end{tabular}
	\end{center}
	where $\sigma \subseteq id$. For rule $EInp$: $x(y).P \stackrel{xw}{\longtwoheadrightarrow}_{2} P\{w/y\}$. $P\equiv_{\beta}^{\sigma}Q$ and $\sigma\subseteq id$ imply $P\equiv_{\alpha}Q$ which in turn imply $P\{w/y\} \equiv_{\alpha} Q\{w/y\}$.
      \item[$(BetaInp1, EInp)$]:
	\begin{center}
	  \begin{tabular}{l}
	      $\inferrule*[left=BetaInp1]{
		  P\equiv_{\beta}^{\sigma}Q
		\\
		  (y \sigma w) \vee (y,w\notin n(\sigma))
		\\
		  (x \sigma x) \vee (x\notin n(\sigma))
	      }{
		  x(y).P\equiv_{\beta}x(w).Q
		\\
		  \sigma \{x\mapsto x\}
	      }$
	    \\
	      $\inferrule*[left=EInp]{
	      }{
		  x(w).Q \stackrel{xa}{\longtwoheadrightarrow}_{2} Q\{a/w\}
	      }$	      
	  \\
	  \end{tabular}
	\end{center}
	where $\sigma \subseteq id$. For rule $EInp$: $x(y).P \stackrel{xa}{\longtwoheadrightarrow}_{2} P\{a/y\}$. The premises of rule $BetaInp$ imply $P\{a/y\} \equiv_{\alpha} Q\{a/w\}$. DA DIMOSTRARE!
      \item[$(BetaOut, Out)$]:
	\begin{center}
	  \begin{tabular}{l}
	      $\inferrule*[left=BetaOut]{
		  P\equiv_{\beta}^{\sigma}Q
		\\
		  (y \sigma y) \vee (y\notin n(\sigma))
		\\
		  (x \sigma x) \vee (x\notin n(\sigma))
	      }{
		  \overline{x}y.P\equiv_{\beta} \overline{x}y.Q
		\\
		  \sigma \cup \{x\mapsto x\} \cup \{y\mapsto y\}
	      }$
	    \\
	      $\inferrule*[left=Out]{
	      }{
		  \overline{x}y.Q \stackrel{\overline{x}y}{\longtwoheadrightarrow}_{2} Q
	      }$	      
	  \\
	  \end{tabular}
	\end{center}
	where $\sigma \subseteq id$. For rule $Out$: $\overline{x}y.P \stackrel{\overline{x}y}{\longtwoheadrightarrow}_{2} P$ 
      \item[$(BetaPar, Par)$]
      \item[$(BetaPar, ECom)$]
      \item[$(BetaRes, Res)$]
      \item[$(BetaRes, Opn)$]
      \item[$(BetaRes1, Res)$]
      \item[$(BetaRes1, Opn)$]
      \item[$(BetaSum, Sum)$]
      \item[$(BetaTau, Tau)$]
    \end{description}
  \end{proof}
\end{lemma}

\begin{lemma}\label{pushAlfaEquivalence}
  If $P\xrightarrow{\lambda}_{2} P^{'}$ then $P\stackrel{\lambda}{\twoheadrightarrow}_{2} P^{''}$ and $P^{'}\equiv_{\alpha} P^{''}$.
\end{lemma}


\section{Bisimilarity, congruence and equivalence}

\subsection{Early bisimilarity}

\begin{definition}\label{strongEarlyBisimulation}
  A \emph{strong early bisimulation} is a symmetric binary relation $\mathbf{S}$ on multi $\pi$ processes such that for all $P$ and $Q$: $P \mathbf{S} Q$, $P \xrightarrow{\gamma} P^{'}$ and $bn(\gamma)\cap fn(P,Q)=\emptyset$ imply that
  \begin{center}
    $\exists Q^{'}:$ $Q \xrightarrow{\gamma} Q^{'}$ and $P^{'}\mathbf{S} Q^{'}$
  \end{center}
  The \emph{strong early bisimilarity}, written $\sim_{E}$, is the union of all strong early bisimulation. Two processes $P,Q$ are \emph{strong early bisimilar}, written $P \sim_{E} Q$, if they are related by the strong early bisimilarity. The strong early bisimilarity is a strong early bisimulation.
\end{definition}

\begin{definition}\label{strongEarlyBisimulationUpTo}
  A \emph{strong early bisimulation up to $\sim_{E}$} is a symmetric binary relation $\mathbf{S}$ on multi $\pi$ processes such that for all $P$ and $Q$: $P \mathbf{S} Q$, $P \xrightarrow{\gamma} P^{'}$ and $bn(\gamma)$ is fresh imply that
  \begin{center}
    $\exists P^{''},Q^{'},Q^{''}:$ $Q \xrightarrow{\gamma} Q^{'}$ and $P^{'} \sim_{E} P^{''} \mathbf{S} Q^{''} \sim_{E} Q^{'} $
  \end{center}
  Two processes $P,Q$ are \emph{strong early bisimilar up to $\sim_{E}$}, written $P \sim_{E}^{up} Q$, if they are related by a strong early bisimulation up to $\sim_{E}$.
\end{definition}

\subsection{Properties of strong early bisimilarity}

\begin{proposition}
  $\sim_{E}$ is an equivalence relation.
  \begin{proof}:
    \begin{description}
      \item[Reflexivity]
	The identity relation on processes is a strong early bisimulation.
      \item[Simmetry]
	It is in the definition.
      \item[Transitivity]
	The composition $\sim_{E} \sim_{E}$ is a strong early bisimulation.
    \end{description}
  \end{proof}
\end{proposition}

\begin{proposition}\label{earlyBisimilarityUpToImplyEarlyBisimilarity}
  $P \sim_{E}^{up} Q$ imply $P \sim_{E} Q$.
  \begin{proof}
    Let $\mathbf{S}$ be a bisimulation up to $\sim_{E}$ such that $P \mathbf{S} Q$. It can be proved that $\sim_{E} \mathbf{S} \sim_{E}$ is a bisimulation: let $A \sim_{E} B \mathbf{S} C \sim_{E} D$
    \begin{center}
      \begin{tabular}{l}
	$A \xrightarrow{\gamma} A^{'}$ $\wedge$ $A \sim_{E} B$ $\wedge$ definition \ref{strongEarlyBisimulation} 
      
	$\Rightarrow \exists B^{'}:$ $B \xrightarrow{\gamma} B^{'}$ $\wedge$ $A^{'}\sim_{E} B^{'}$
      \\
	$B \mathbf{S} C$ $\wedge$ definition \ref{strongEarlyBisimulationUpTo}
      
	$\Rightarrow \exists C^{'} C^{''} B^{''}:$ $C \xrightarrow{\gamma} C^{'}$ $\wedge$ $B^{'} \sim_{E} B^{''} \mathbf{S} C^{''} \sim_{E} C^{'}$
      \\
	$C \xrightarrow{\gamma} C^{'}$ $\wedge$ $C \sim_{E} D$ $\wedge$ definition \ref{strongEarlyBisimulation} 
      
	$\Rightarrow \exists D^{'}:$ $D \xrightarrow{\gamma} D^{'}$ $\wedge$ $C^{'}\mathbf{S} D^{'}$
      \\
	$A^{'} \sim_{E} B^{'} \sim_{E} B^{''} \mathbf{S} C^{''} \sim_{E} C^{'} \sim_{E} D^{'}$ $\wedge$ transitivity of $\sim_{E}$
	$\Rightarrow$ $A^{'} \sim_{E} B^{''} \mathbf{S} C^{''} \sim_{E} D^{'}$
      \end{tabular}
    \end{center}
    It is easy to see that the symmetric also holds.
  \end{proof}
\end{proposition}

\begin{proposition}
  $\equiv_{\alpha}$ is a strong early bisimulation.
  \begin{proof}:
    \begin{itemize}
      \item
	Let $P\equiv_{\alpha} Q$ and $P\xrightarrow{\gamma}P^{'}$. For symmetry of $\alpha$ conversion: $Q\equiv_{\alpha}P$. For rule $Alp$: $Q\xrightarrow{\gamma}P^{'}$ and for reflexivity $P^{'}\equiv_{\alpha}P^{'}$.
      \item
	Let $P\equiv_{\alpha} Q$ and $Q\xrightarrow{\gamma}Q^{'}$ then for rule $Alp$: $P\xrightarrow{\gamma}Q^{'}$ and for reflexivity $Q^{'}\equiv_{\alpha}Q^{'}$
    \end{itemize}
  \end{proof}
\end{proposition}


\begin{lemma}
  Output prefixing preserves early bisimulation. 
  \begin{proof}
    We prove that $\{(\overline{x}y.P, \overline{x}y.Q): P\sim_{E}Q\}\cup \sim_{E}$ is a strong early bisimulation. Let $\overline{x}y.P\xrightarrow{\gamma}P^{'}$ then for lemma \ref{pushAlfaEquivalence}: $\overline{x}y.P\stackrel{\gamma}{\longtwoheadrightarrow} R$ and $R\equiv_{\alpha}P^{'}$. The only rule that can be applied to derive the latter transition is $Out$ so $\gamma = \overline{x}y$ and $R=P$. For rule $Out$: $\overline{x}y.Q\xrightarrow{\gamma} Q$. Putting it all together: 
    \begin{center}
      $\overline{x}y.P\xrightarrow{\overline{x}y}P^{'} \equiv_{\alpha} P \sim_{E} Q \stackrel{\overline{x}y}{\longleftarrow} \overline{x}y.Q$
    \end{center}
  \end{proof}
\end{lemma}


\begin{lemma}
  $\tau$ prefixing preserves early bisimulation. 
  \begin{proof}
    We prove that $\{(\tau.P, \tau.Q): P\sim_{E}Q\}\cup \sim_{E}$ is a strong early bisimulation. Let $\tau.P\xrightarrow{\gamma}P^{'}$ then for lemma \ref{pushAlfaEquivalence}: $\tau.P\stackrel{\gamma}{\longtwoheadrightarrow} R$ and $R\equiv_{\alpha}P^{'}$. The only rule that can be applied to derive the latter transition is $Tau$ so $\gamma = \tau$ and $R=P$. For rule $Out$: $\tau.Q\xrightarrow{\gamma} Q$. Putting it all together: 
    \begin{center}
      $\tau.P\xrightarrow{\tau}P^{'} \equiv_{\alpha} P \sim_{E} Q \stackrel{\tau}{\longleftarrow} \tau.Q$
    \end{center}
  \end{proof}
\end{lemma}


\begin{lemma}
  Sum preserves early bisimulation. 
  \begin{proof}
    We prove that $\{(P+R, Q+R): P\sim_{E}Q\}\cup \sim_{E}$ is a strong early bisimulation. Let $P+R\xrightarrow{\gamma}P^{'}$ then for lemma \ref{pushAlfaEquivalence}: $P+R\stackrel{\gamma}{\longtwoheadrightarrow} S$ and $S\equiv_{\alpha}P^{'}$. The only rules that can be applied to derive the latter transition are $SumL$ or $SumR$. We show just the case of $SumL$, so $P\stackrel{\gamma}{\longtwoheadrightarrow} S$. $P\sim_{E} Q$ and $P\stackrel{\gamma}{\longtwoheadrightarrow} S$ imply $Q\xrightarrow{\gamma} T$ and $S\sim_{E} T$. For rule $SumL$: $Q+R\xrightarrow{\gamma} T$. Putting it all together:
    \begin{center}
      $P+R\xrightarrow{\gamma}P^{'} \equiv_{\alpha} S \sim_{E} T \stackrel{\gamma}{\longleftarrow} Q+R$
    \end{center}
  \end{proof}
\end{lemma}

\begin{lemma}
  Restriction preserves early bisimulation.
  \begin{proof}:
      We prove that the relation $Res(\sim_{E})=\{((\nu x)P, (\nu x)Q): P\sim_{E} Q\} \cup \sim_{E}$ is a strong early bisimulation up to $\alpha$ equivalence. This imply that $Res(\sim_{E})$ is a strong early bisimulation. If $(\nu x)P\xrightarrow{\gamma}P^{''}$ then for lemma \ref{pushAlfaEquivalence}: $(\nu x)P\stackrel{\gamma}{\twoheadrightarrow}P^{'}$ and $P^{'}\equiv_{\alpha}P^{''}$. So the proof can go on by cases on the last rule of the derivation of $(\nu x)P\stackrel{\gamma}{\twoheadrightarrow} P^{'}$:
	\begin{description}
 	  \item[$Res$]:
   	    \begin{center}
   	      $\inferrule* [left=\bf{Res}]{
		    P \stackrel{\gamma}{\longtwoheadrightarrow} P_{1}^{'}
		  \\
		    x \notin n(\gamma)
		  }{
		    (\nu x)P_{1} \stackrel{\gamma}{\longtwoheadrightarrow} (\nu x)P_{1}^{'}
	      }$
   	    \end{center}
 	    $P\sim_{E}Q$ and $P \stackrel{\gamma}{\longtwoheadrightarrow} P_{1}^{'}$ imply $Q \xrightarrow{\gamma} Q^{'}$ and $Q^{'} \sim_{E} P_{1}^{'}$. Also $(\nu x)P_{1}^{'} \equiv_{\alpha} P^{''}$. For rule $Res$: $(\nu x)Q \xrightarrow{\gamma} (\nu x)Q^{'}$. Putting it all together:
 	    \begin{center}
 	      $(\nu x)P \xrightarrow{\gamma} P^{''} \equiv_{\alpha} (\nu x)P_{1}^{'}  Res(\sim_{E}) (\nu x)Q^{'} \stackrel{\gamma}{\leftarrow} (\nu x)Q$
 	    \end{center}
  	  \item[$Opn$] similar.
	\end{description}
  \end{proof}
\end{lemma}


\begin{lemma}
  Parallel composition preserves early bisimulation.
  \begin{proof}
    We prove that the relation $Par(\sim_{E})=\{(P|R, Q|R): P\sim_{E} Q\} \cup \sim_{E}$ is a strong early bisimulation up to $\alpha$ equivalence. This imply that $Par(\sim_{E})$ is a strong early bisimulation. Let $P|R \xrightarrow{\gamma} P^{'}$ then for lemma \ref{pushAlfaEquivalence}: $P|R \stackrel{\gamma}{\twoheadrightarrow} S$ and $S\equiv_{\alpha} P^{'}$. The proof goes on by cases on the last rule of the derivation of $P|R \stackrel{\gamma}{\twoheadrightarrow} S$:
    \begin{description}
      \item[$EComL$]:
	    \begin{center}
	      $\inferrule* [left=\bf{EComL}]{
		      P \stackrel{\overline{x}y}{\twoheadrightarrow} P_{1}^{'}
		    \\
		      R \stackrel{xy}{\twoheadrightarrow} R_{1}^{'}
		  }{
		    P|R \stackrel{\tau}{\twoheadrightarrow} P_{1}^{'}|R_{1}^{'}
		  }$
	    \end{center}
	$P\sim_{E} Q$ and $P \stackrel{\overline{x}y}{\twoheadrightarrow} P_{1}^{'}$ imply that there exists a process $Q^{'}$ such that $Q \xrightarrow{\overline{x}y} Q^{'}$ and $P_{1}^{'}\sim_{E} Q^{'}$. For rule $EComL$: $Q|R \xrightarrow{\tau} Q^{'}|R_{1}^{'}$. Putting it all together:
	\begin{center}
	  $P|R \stackrel{\tau}{\twoheadrightarrow} P^{'} \equiv_{\alpha} P_{1}^{'}|R_{1}^{'} Par(\sim_{E}) Q^{'}|R_{1}^{'} \stackrel{\tau}{\leftarrow} Q|R$
	\end{center}
      \item[$ClsL$]:
% 	    \begin{center}
% 	      $\inferrule* {
% 		  P \xrightarrow{\overline{x}(y) \cdot (\nu y)} P^{'}
% 		\\
% 		  R \xrightarrow{xy} R^{'}
% 	      }{
% 		P|R \xrightarrow{\tau} (\nu y)(P^{'}|R^{'})
% 	      }$
% 	    \end{center}
% 	    $P \xrightarrow{\overline{x}(y) \cdot (\nu y)} P^{'}$ and $P\sim_{E} Q$ imply that there exists a process $Q^{'}$ such that $Q \xrightarrow{\overline{x}(y) \cdot (\nu y)} Q^{'}$ and $P^{'} \sim_{E} Q^{'}$. So for rule $Cls$: $Q|R \xrightarrow{\tau} (\nu y)(Q^{'}|R^{'})$ and $(\nu y)(P^{'}|R^{'}) \sim_{E} (\nu y)(Q^{'}|R^{'})$
      \item[$EComR, ClsR, ParL, ParR$] similar.
    \end{description}
  \end{proof}
\end{lemma}


\begin{example}
  $\sim_{E}$ is not in general preserved by input prefixing because:
    \begin{center}
      $a(x).0 | \overline{b}y.0 \sim_{E} a(x).\overline{b}y.0 + \overline{b}y.a(x).0$
    \end{center}
    but 
    \begin{center}
      $c(a).(a(x).0 | \overline{b}y.0) \dot{\not\sim}_{E} c(a).(a(x).\overline{b}y.0 + \overline{b}y.a(x).0)$
    \end{center}
    because
    \begin{center}
      \begin{tabular}{l}
	  $c(a).(a(x).0 | \overline{b}y.0) \xrightarrow{cb} b(x).0 | \overline{b}y.0 \xrightarrow{\tau} 0|0$
	\\
	  $c(a).(a(x).\overline{b}y.0 + \overline{b}y.a(x).0) \xrightarrow{cb} b(x).\overline{b}y.0 + \overline{b}y.b(x).0 \not\xrightarrow{\tau}$
      \end{tabular}
    \end{center}
\end{example}


\subsection{Congruence}

\subsection{Strong D equivalence}

\begin{definition}\label{distinction}
  A \emph{distinction} is a finite symmetric and irreflexive binary relation on names. A substitution $\sigma$ \emph{respects} a pair $(a,b)$ if 
  \begin{center}
     $a\sigma\neq b\sigma$
  \end{center}
  A substitution $\sigma$ \emph{respects} a distinction $D$ if it respects every pair in the distinction:
  \begin{center}
     $\forall a,b.$ $aDb$ $\Rightarrow$ $a\sigma\neq b\sigma$
  \end{center}
  We write $D \cdot \sigma$ for the composition of the two relation.
\end{definition}

\begin{example}
  The empty relation $\emptyset$ is a distinction. Every substitution respects the empty distinction.
\end{example}

\begin{definition}
  Let $D$ be a distinction and $A$ be a set of names
  \begin{center}
    $D-A \stackrel{def}{=} D - (A\times \mathcal{N} \cup \mathcal{N} \times A)$
  \end{center}
\end{definition}

\begin{definition}
  Let $D$ be a distinction and $\sigma$ be a substitution. The application of $\sigma$ to $D$ is defined as:
  \begin{center}
    $D\sigma \stackrel{def}{=} \{(a\sigma,b\sigma): (a,b)\in D\}$
  \end{center}
\end{definition}

\begin{proposition}
  Let $D,D^{'}$ be distinctions and $\sigma$ be a substitution. Then
  \begin{center}
    $D^{'}\subseteq D$ and $\sigma$ respects $D$ imply $\sigma$ respects $D^{'}$
  \end{center}
\end{proposition}


\begin{lemma}\label{distinctionSubstitution}
  Let $\sigma$ be a substitution, $D$ be a distinction and $c\notin n(D)$. If $\sigma$ respects $D$ then $\sigma\{c/x\}$ respects $D-\{x\}$.
  \begin{proof}:
    $\sigma$ respects $D$ and $D-\{x\}\subseteq D$ imply $\sigma$ respects $D-\{x\}$. $(d_{1},d_{2}) \in (D-\{x\})$ imply $d_{1} \sigma\{c/x\} = d_{1} \sigma$ and $d_{2} \sigma = d_{2} \sigma\{c/x\}$. $\sigma$ respects $D-\{x\}$ and $(d_{1},d_{2}) \in (D-\{x\})$ for definition \ref{distinction} imply $d_{1} \sigma \neq d_{2} \sigma$.  Putting it all together $\sigma \{c/x\}$ respects $(d_{1}, d_{2})$.
  \end{proof}
\end{lemma}


\begin{definition}\label{strongDequivalence}
  $P$ and $Q$ are \emph{strongly D equivalent}, written $P \sim^{D} Q$, if for all substitution $\sigma$ respecting $D$: $P\sigma \sim_{E} Q\sigma$. In this definition we assume that the application of $\sigma$ to $P$ and $Q$ does not change any bound name.
\end{definition}

 
\begin{lemma}\label{strongDEquivalenceIsAnEquivalence}
  For any distinction $D$ $\sim^{D}$ is an equivalence relation
  \begin{proof}
    $\sim^{D}$ is an equivalence relation because $\sim_{E}$ is an equivalence relation.
    \begin{description}
      \item[$Reflexivity$]
	Since $\sim_{E}$ is reflexive, for all substitution $\sigma$ respecting $D$: $P\sigma \sim_{E} Q\sigma$ so $P \sim^{D} P$
      \item[$Symmetry$]
	Let $P \sim^{D} Q$ then for all substitution $\sigma$ respecting $D$: $P\sigma \sim_{E} Q\sigma$. Since $\sim_{E}$ is symmetric $Q\sigma \sim_{E} P\sigma$ so $Q \sim^{D} P$
      \item[$Transitivity$]
	Let $P \sim^{D} Q$ and $Q \sim^{D} R$ then for all substitution $\sigma$ respecting $D$: $P\sigma \sim_{E} Q\sigma$ and $Q\sigma \sim_{E} R\sigma$. Since $\sim_{E}$ is transitive $P\sigma \sim_{E} R\sigma$ so $P \sim^{D} R$.
    \end{description}
  \end{proof}
\end{lemma}

\begin{lemma}\label{pushSubstitution}
  If $P\{c/y\} \stackrel{\gamma}{\twoheadrightarrow} P^{'}$ and $c$ is fresh then $P \xrightarrow{\gamma\{y/c\}} Q$ and $P^{'}\equiv_{\alpha}Q\{y/c\}$.
  \begin{proof}
    
  \end{proof}
\end{lemma}

\begin{lemma}\label{substitutionOverTransition}
  If $P \stackrel{\gamma}{\twoheadrightarrow} P^{'}$ and $c$ is fresh then $P\{c/y\} \xrightarrow{\gamma\{c/y\}} Q$ and $P^{'}\equiv_{\alpha}Q\{c/y\}$.
  \begin{proof}
    
  \end{proof}
\end{lemma}



\begin{lemma}\label{freshSubstitutionPreservesEarlyBisimulation}
  If $P \sim_{E} Q$ and $c$ fresh then $P\{c/y\} \sim_{E} Q\{c/y\}$.
  \begin{proof}
    $Sub(\sim_{E})=\{(P\{c/y\}, Q\{c/y\}): P\sim_{E}Q\; \wedge c\notin n(P,Q)\}$ is a strong early bisimulation. Let $P\{c/y\} \xrightarrow{\gamma} P^{'}$ then for lemma \ref{pushAlfaEquivalence}: $P\{c/y\} \stackrel{\gamma}{\twoheadrightarrow} P^{''}$ and $P^{''}\equiv_{\alpha}P^{'}$. For lemma \ref{pushSubstitution}: $P \xrightarrow{\gamma \{y/c\}} R$ and $R\equiv_{\alpha}P^{''}\{y/c\}$. Since $P\sim_{E}Q$ then $Q \xrightarrow{\gamma \{y/c\}} S$ and $S\sim_{E} R$. For lemma \ref{pushSubstitution}: $Q \stackrel{\gamma \{y/c\}}{\longtwoheadrightarrow} T$ and $T\equiv_{\alpha}S$. For lemma \ref{substitutionOverTransition}: $Q\{c/y\} \xrightarrow{\gamma} U$ and $U \equiv_{\alpha} T\{y/c\}$ Putting it all together:
    \begin{center}
      $P\{c/y\} \xrightarrow{\gamma} P^{'} \equiv_{\alpha} P^{''} \equiv_{\alpha} R\{c/y\} Sub(\sim_{E}) S\{c/y\} \equiv_{\alpha} T\{c/y\} \equiv_{\alpha} U \stackrel{\gamma}{\leftarrow} Q\{c/y\}$
    \end{center}
  \end{proof}
\end{lemma}


\begin{lemma}\label{strongDEquivalencePreservedByInput}
  If $P \sim^{D} Q$ then $x(y).P \sim^{D-y} x(y).Q$?
  \begin{proof}
    Let $\sigma$ be a substitution that respects $D$. Then we have various cases:
    \begin{itemize}
      \item 
	$(x(y).P)\sigma = x\sigma(y).P\sigma$ and $(x(y).Q)\sigma = x\sigma(y).Q\sigma$. Let $x\sigma (y).P\sigma \xrightarrow{\gamma} P^{'}$ then for lemma \ref{pushAlfaEquivalence}: $x\sigma (y).P\sigma \stackrel{x\sigma w}{\longtwoheadrightarrow} (P\sigma)\{w/y\}$ and $(P\sigma)\{w/y\} \equiv_{\alpha} P^{'}$. for rule $EInp$: $x\sigma (y).Q\sigma \xrightarrow{x\sigma w} (Q\sigma)\{w/y\}$. If $\sigma$ respects $D$ then $\sigma\{w/y\}$ respects $D-y$ and so for definition of strong D equivalence: $(P\sigma)\{w/y\} \sim_{E} (Q\sigma)\{w/y\}$. Putting it all together:
	\begin{center}
	  $(x(y).P)\sigma \xrightarrow{\; x\sigma w \;} P^{'} \equiv_{\alpha} (P\sigma)\{w/y\} \sim_{E} (Q\sigma)\{w/y\} \stackrel{x\sigma w}{\longleftarrowB} (x(y).Q)\sigma$
	\end{center}
      \item
	$(x(y).P)\sigma = x\sigma(c).P\{c/y\}\sigma$, $(x(y).Q)\sigma = x\sigma(c).Q\{c/y\}\sigma$ and $c$ is fresh in $D$, in $\sigma$ and in the processes $P,Q$. Let $x\sigma(c).P\{c/y\}\sigma \xrightarrow{\gamma} P^{'}$ then for lemma \ref{pushAlfaEquivalence}: 
	\begin{center}
	  $x\sigma(c).P\{c/y\}\sigma \stackrel{x\sigma w}{\Longtwoheadrightarrow} P\{c/y\}\sigma \{w/c\}$ and $P\{c/y\}\sigma \{w/c\}\equiv_{\alpha} P^{'}$. 
	\end{center}
	For rule $EInp$: $x\sigma(c).Q\{c/y\}\sigma \xrightarrow{x\sigma w} Q\{c/y\}\sigma\{w/c\}$. Since $c$ is fresh we can apply lemma \ref{freshSubstitutionPreservesEarlyBisimulation} in order to get: $P\{c/y\} \sim_{E} Q\{c/y\}$. If $\sigma$ respects $D$ then $\sigma\{w/c\}$ respects $D-c=D$ and so for definition of strong D equivalence: $(P\{c/y\})\sigma\{w/c\} \sim_{E} (Q\{c/y\})\sigma\{w/c\}$. Putting it all together:
	\begin{center}
	  $(x(y).P)\sigma \xrightarrow{\; x\sigma w \;} P^{'} \equiv_{\alpha} (P\{c/y\})\sigma \{w/c\} Sub(\sim_{E}) (Q\{c/y\})\sigma\{w/c\} \stackrel{x\sigma w}{\longleftarrowB} (x(y).Q)\sigma$
	\end{center}
    \end{itemize}

  \end{proof}
\end{lemma}


\begin{lemma}\label{stringDEquivalencePreservedByAllExceptInput}
      If $P \sim^{D} Q$ then 
      \begin{itemize}
	\item 
	  $\tau.P \sim^{D} \tau.Q$
	\item 
	  $\overline{x}y.P \sim^{D} \overline{x}y.Q$
	\item 
	  $\underline{\overline{x}y}.P \sim^{D} \underline{\overline{x}y}.Q$
	\item
	  $P+R \sim^{D} Q+R$
	\item
	  $P|R \sim^{D} Q|R$
	\item
	  $(\nu x)P \sim^{D-x} (\nu x)Q$
      \end{itemize}
  \begin{proof}
    $\sim^{D}$ is preserved by every operator. Let $P \sim^{D} Q$ and let $\sigma$ be a substitution respecting $D$ so $P\sigma \sim_{E} Q\sigma$:
    \begin{description}
      \item[Output prefixing]\hfill \\
	\begin{center}
	  \begin{tabular}{ll}
	      $P \sim^{D} Q$
	    &
	      definition \ref{strongDequivalence}
	  \\
	      $\Rightarrow$ $\forall \sigma$ respecting $D.$ $P\sigma \sim_{E} Q\sigma$
	    &
	      lemma \ref{outputPreservesEarlyBisimulation}
	  \\
	      $\Rightarrow$ $(\overline{x}y)\sigma.(P\sigma) \sim_{E} (\overline{x}y)\sigma.(Q\sigma)$
	    &
	      definition of substitution
	  \\
	      $\Rightarrow$ $(\overline{x}y.P)\sigma \sim_{E} (\overline{x}y.Q)\sigma$
	    &
	      definition \ref{strongDequivalence}
	  \\
	      $\Rightarrow$ $\overline{x}y.P \sim^{D} \overline{x}y.Q$
	    &
	  \end{tabular}
	\end{center}
      \item[Tau prefixing]\hfill \\
	\begin{center}
	  \begin{tabular}{ll}
	      $P \sim^{D} Q$
	    &
	      definition \ref{strongDequivalence}
	  \\
	      $\Rightarrow$ $\forall \sigma$ respecting $D.$ $P\sigma \sim_{E} Q\sigma$
	    &
	      lemma \ref{tauPreservesEarlyBisimulation}
	  \\
	      $\Rightarrow$ $\tau.(P\sigma) \sim_{E} \tau.(Q\sigma)$
	    &
	      definition of substitution
	  \\
	      $\Rightarrow$ $(\tau.P)\sigma \sim_{E} (\tau.Q)\sigma$
	    &
	      definition \ref{strongDequivalence}
	  \\
	      $\Rightarrow$ $\tau.P \sim^{D} \tau.Q$
	    &
	  \end{tabular}
	\end{center}
      \item[Sum]\hfill \\
	\begin{center}
	  \begin{tabular}{ll}
	      $P \sim^{D} Q$
	    &
	      definition \ref{strongDequivalence}
	  \\
	      $\Rightarrow$ $\forall \sigma$ respecting $D.$ $P\sigma \sim_{E} Q\sigma$
	    &
	      lemma \ref{sumPreservesEarlyBisimulation}
	  \\
	      $\Rightarrow$ $(P\sigma)+(R\sigma) \sim_{E} (Q\sigma)+(R\sigma)$
	    &
	      definition of substitution
	  \\
	      $\Rightarrow$ $(P+R)\sigma \sim_{E} (Q+R)\sigma$
	    &
	      definition \ref{strongDequivalence}
	  \\
	      $\Rightarrow$ $P+R \sim^{D} Q+R$
	    &
	  \end{tabular}
	\end{center}
      \item[Parallel composition]\hfill \\
	\begin{center}
	  \begin{tabular}{ll}
	      $P \sim^{D} Q$
	    &
	      definition \ref{strongDequivalence}
	  \\
	      $\Rightarrow$ $\forall \sigma$ respecting $D.$ $P\sigma \sim_{E} Q\sigma$
	    &
	      lemma \ref{parallelCompositionEarlyBisimulation}
	  \\
	      $\Rightarrow$ $(P\sigma)|(R\sigma) \sim_{E} (Q\sigma)|(R\sigma)$
	    &
	      definition of substitution
	  \\
	      $\Rightarrow$ $(P|R)\sigma \sim_{E} (Q|R)\sigma$
	    &
	      definition \ref{strongDequivalence}
	  \\
	      $\Rightarrow$ $P|R \sim^{D} Q|R$
	    &
	  \end{tabular}
	\end{center}
      \item[Restriction]
	We have two cases. The first is $((\nu x) P)\sigma=(\nu x)(P\sigma)$:
	\begin{center}
	  \begin{tabular}{ll}
	      $P \sim^{D} Q$
	    &
	      definition \ref{strongDequivalence}
	  \\
	      $\Rightarrow$ $\forall \sigma$ respecting $D.$ $P\sigma \sim_{E} Q\sigma$
	    &
	      lemma \ref{restrictionPreservesEarlyBisimulation}
	  \\
	      $\Rightarrow$ $(\nu x)(P\sigma) \sim_{E} (\nu x)(Q\sigma)$
	    &
	      definition of substitution 
	  \\
	      $\Rightarrow$ $((\nu x)P)\sigma \sim_{E} ((\nu x)Q)\sigma$
	    &
	      definition \ref{strongDequivalence}
	  \\
	      $\Rightarrow$ $(\nu x)P \sim^{D} (\nu x)Q$
	    &
 	  \\
 	      $\Rightarrow$ $(\nu x)P \sim^{D-\{x\}} (\nu x)Q$
 	    &
	  \end{tabular}
	\end{center}		
	The second case is $((\nu x) P)\sigma=(\nu c)(P\{c/x\}\sigma)$ where $c\notin n(P,Q)$ and $c \sigma = c$:
	\begin{center}
	  \begin{tabular}{ll}
 	      $\sigma$ respects $D-\{x\}$
 	    &
 	      lemma \ref{distinctionSubstitution2}
 	  \\
 	      $\Rightarrow \{c/x\}\sigma$ respects $D$
 	    &
 	      definition \ref{strongDequivalence} and $P \sim^{D} Q$
 	  \\
 	      $\Rightarrow$ $P\{c/x\}\sigma \sim_{E} Q\{c/x\}\sigma$
 	    &
 	      lemma \ref{earlyBisimulationProprerties}
 	  \\
 	      $\Rightarrow$ $(\nu c)(P\{c/x\}\sigma) \sim_{E} (\nu c)(Q\{c/x\}\sigma)$
 	    &
 	      definition of substitution 
 	  \\
 	      $\Rightarrow$ $((\nu x)P)\sigma \sim_{E} ((\nu x)Q)\sigma$
 	    &
 	      definition \ref{strongDequivalence}
 	  \\
 	      $\Rightarrow$ $(\nu x)P \sim^{D-\{x\}} (\nu x)Q$
 	    &
 	  \end{tabular}
 	\end{center}		
    \end{description}
  \end{proof}
\end{lemma}



\begin{theorem}
  $\sim^{\emptyset}$ is a congruence.
  \begin{proof}
    Lemma \ref{strongDEquivalenceIsAnEquivalence} and put $D=\emptyset$ in lemma \ref{stringDEquivalencePreservedByAllExceptInput} and in lemma \ref{strongDEquivalencePreservedByInput}
  \end{proof}
\end{theorem}


% \subsection{Open bisimilarity}
% 
% \begin{definition}
%   A \emph{distinction} is a finite symmetric and irreflexive binary relation on names. A substitution $\sigma$ \emph{respects} a distinction $D$ if for each name $a,b$ $aDb$ implies $\sigma(a)\neq \sigma(b)$. We write $D\sigma$ for the composition of the two relation.
% \end{definition}
% 
% \begin{definition}
%   An \emph{strong open simulation}(according to \cite{parrow}) is $\{S_{D}\}_{\mathbb{D}}$ a family of binary relations on processes such that for each process $P, Q$, for each distinction $D\in \mathbb{D}$, for each name substitution $\sigma$ which respects $D$ if $P S_{D} Q$, $P\sigma \xrightarrow{\alpha} P^{'}$ and $bn(\alpha)\cap (fn(P\sigma)\cup fn(Q\sigma))=\emptyset$ then:
%    \begin{itemize}
%     \item 
%       if $\alpha=\overline{a}(x)$ then there exists $Q^{'}$ such that $Q\sigma \xrightarrow{\overline{a}(x)} Q^{'}$ and $P^{'} S_{D^{'}} Q^{'}$ where 
%       \begin{center}
% 	$D^{'}=D\sigma \cup (\{x\}\times (fn(P\sigma)\cup fn(Q\sigma))) \cup  ((fn(P\sigma)\cup fn(Q\sigma))\times\{x\})$
%       \end{center}
%     \item
%       if $\alpha$ is not a bound output then there exists $Q^{'}$ such that $Q\sigma \xrightarrow{\alpha} Q^{'}$ and $P^{'} S_{D\sigma} Q^{'}$
%   \end{itemize}
%   $P$ and $Q$ are \emph{open $D,\mathbb{D}$ bisimilar}, written $P \sim_{O}^{D,\mathbb{D}} Q$ if there exists $\{S_{D}\}_{\mathbb{D}}$ such that: $\{S_{D}\}_{\mathbb{D}}$ and $\{S_{D}^{-1}\}_{\mathbb{D}}$ are open simulation and $P S_{D} Q$ with $D\in \mathbb{D}$. $P$ and $Q$ are \emph{open bisimilar} if for some $\mathbb{D}$ they are open $\emptyset,\mathbb{D}$ bisimilar, written $P \sim_{O} D$.
% \end{definition}
% 
% \begin{lemma}
%   Substitution preserves open bisimulation.
%   \begin{proof}
%     Let $P\sim_{O}^{\emptyset, \mathbb{D}}Q$ and let $\{a/b\}$ be a substitution then we have to prove that $P\{a/b\}\sim_{O}^{\emptyset, \mathbb{D}}Q\{a/b\}$.
%   \end{proof}
% \end{lemma}
% 
% 
% \begin{lemma}
%   Input prefixing preserves open bisimulation.
%   \begin{proof}
%     Let $P\sim_{O}^{\emptyset, \mathbb{D}}Q$ and let $\{a/b\}$ be a substitution which respects $\emptyset$. We have four cases according to the definition of substitution:
%     \begin{itemize}
%       \item 
% 	$(x(y).P)\{a/b\} = x\{a/b\}(y).P\{a/b\}$
%       \item 
% 	$(x(b).P)\{a/b\} = x\{a/b\}(b).P$
%       \item
% 	$c\notin n(x(a).P)$, $b\in fn(P)$ and $(x(a).P)\{a/b\} = x\{a/b\}(c).P\{c/a\}\{a/b\}$
%       \item
% 	$b\notin fn(P)$ and $(x(a).P)\{a/b\} = x\{a/b\}(a).P$
%     \end{itemize}
%   \end{proof}
% \end{lemma}
% 
% \begin{theorem}
%   Open bisimulation is a congruence.
%   \begin{proof}
%     
%   \end{proof}
% \end{theorem}

 
 




