
The $\pi$ calculus is a mathematical model of processes whose interconnections change as they interact. The basic computational step is the transfer of a communications link between two processes. The idea that the names of the links belong to the same category as the transferred objects is one of the cornerstone of the calculus. The $\pi$ calculus allows channel names to be communicated along the channels themselves, and in this way it is able to describe concurrent computations whose network configuration may change during the computation.

A coverage of $\pi$ calculus is on \cite{parrow}, \cite{sangiorgiwalker} and \cite{milner}

\section{Syntax}
We suppose that we have a countable set of names $\mathbb{N}$, ranged over by lower case letters $a,b, \cdots, z$. This names are used for communication channels and values. Furthermore we have a set of identifiers, ranged over by $A$. We represent the agents or processes by upper case letters $P,Q, \cdots $. A process can perform the following actions:
\begin{center}
  $\pi$ ::= $\overline{x}y$ | $x(z)$ | $\tau$ 
\end{center}
The process are defined by the following grammar:
\begin{center}
  \begin{tabular}{l}
    $P,Q$ ::= $0$ | $\pi.P$ | $P|Q$ | $P+Q$ | $(\nu x) P$ | $A(y_{1}, \cdots, y_{n})$ 
  \end{tabular}
\end{center}
and they have the following intuitive meaning:
\begin{description}
  \item[$0$] 
    is the empty process, which cannot perform any actions
  \item[$\pi.P$] 
    is an action prefixing, this process can perform action $\pi$ e then behave like $P$, the action can be:
    \begin{description}
      \item[$\overline{x}y$] 
	is an output action, this sends the name $y$ along the name $x$. We can think about $x$ as a channel or a port, and about $y$ as an output datum sent over the channel
      \item[$x(z)$] 
	is an input action, this receives a name along the name $x$. $z$ is a variable which stores the received data.
      \item[$\tau$] 
	is a silent or invisible action, this means that a process can evolve to $P$ without interaction with the environment 
    \end{description}
  \item[$P+Q$] 
    is the sum, this process can enact either $P$ or $Q$
  \item[$P|Q$] 
    is the parallel composition, $P$ and $Q$ can execute concurrently and also syncronize with each other
  \item[$(\nu z) P$] 
    is the scope restriction. This process behave as $P$ but the name $z$ is local. This process cannot use the name $z$ to interact with other process but it can for communication within it.
  \item[$A(y_{1}, \cdots, y_{n})$] 
    is an identifier whose arity is $n$. Every identifier has a definition
    \begin{center}
      $A(x_{1}, \cdots, x_{n}) = P$
    \end{center}
    where the $x_{i}$ must be pairwise disjoint. The intuition is that if the $y_{i}$ replace the $x_{i}$ then $A(y_{1}, \cdots, y_{n})$ behave as $P\{y_{1}/x_{1}\} \cdots \{y_{n}/x_{n}\}$. 
\end{description}

To resolve ambiguity we can use parentheses and observe the conventions that prefixing and restriction bind more tightly than composition and prefixing binds more tightly than sum. 

\begin{definition} \index{binder} \index{bind} \index{name occurrence! bound} \index{scope}
  We say that the input prefix $x(z).P$ \emph{binds} $z$ in $P$ or is a \emph{binder} for $z$ in $P$. We also say that $P$ is the \emph{scope} of the binder and that any occurrence of $z$ in $P$ are \emph{bound} by the binder. Also the restriction operator $(\nu z)P$ is a binder for $z$ in $P$.
\end{definition}

\begin{definition} \index{$bn$}
  $bn(P)$ is the set of names that have a bound occurrence in $P$ and is defined as $B(P, \emptyset)$, where $B(P, I)$, with $I$ a set of process constants, is defined in table \ref{table:B}
\end{definition}

  \begin{table}
    \begin{tabular}{ll}
      \hline\\
	$B(0, I)\; =\; \emptyset$&$B(Q+R,I)\; =\; B(Q,I)\cup B(R,I)$
      \\\\
	$B(\overline{x}y.Q, I)\; =\; B(Q, I)$&$B(Q|R,I)\; =\; B(Q,I)\cup B(R,I)$
      \\\\
	$B(x(y).Q, I)\; =\; \{y,\overline{y}\}\cup B(Q, I)$&$B((\nu x)Q, I)\; =\; \{x, \overline{x}\}\cup B(Q, I)$
      \\\\
	$B(\tau.Q, I)\; =\; B(Q, I)$&
      \\\\
	\multicolumn{2}{l}{
	$B(A(x_{1},\cdots, x_{n}), I)=\left\{
	  \begin{array}{ll}
		B(Q, I\cup \{A\})\; where\; A\stackrel{def}{=}Q
	      &
		if\; A\notin I
	    \\
		\emptyset
	      &
		if\; A\in I
	  \end{array}\right.$}
      \\\hline
    \end{tabular}
    \caption{Bound occurrences}
    \label{table:B}
  \end{table}



\begin{definition} \index{name occurrence! free}
  We say that a name $x$ is \emph{free} in $P$ if $P$ contains a non bound occurrence of $x$. We write $fn(P)$ for the set of names with a free occurrence in $P$. $fn(P)$ is defined as $fn(P,\emptyset)$ where $fn(P, I)$, with $I$ a set of process constants, is defined in table \ref{F}
\end{definition}

  \begin{table}
    \begin{tabular}{ll}
      \hline\\
	$F(0, I)\; =\; \emptyset$&$F(Q+R,I)\; =\; F(Q,I)\cup F(R,I)$
      \\\\
	$F(\overline{x}y.Q, I)\; =\; \{x,\overline{x},y,\overline{y}\}\cup F(Q, I)$&$F(Q|R,I)\; =\; F(Q,I)\cup F(R,I)$
      \\\\
	$F(x(y).Q, I)\; =\; \{x,\overline{x}\}\cup (F(Q, I)-\{y,\overline{y}\})$&$F((\nu x)Q, I)\; =\; F(Q, I)-\{x,\overline{x}\}$
      \\\\
	$F(\tau.Q, I)\; =\; F(Q, I)$
      \\\\
	\multicolumn{2}{l}{
	$F(A(x_{1},\cdots, x_{n}), I)=\left\{
	  \begin{array}{ll}
		F(Q, I\cup \{A\})\; where\; A\stackrel{def}{=}Q
	      &
		if\; A\notin I
	    \\
		\emptyset
	      &
		if\; A\in I
	  \end{array}\right.$
	}
      \\\hline
    \end{tabular}
    \caption{Free occurrences}
    \label{F}
  \end{table}



\begin{definition} \index{n}
  $n(P)$ which is the set of all names in $P$ and is defined in the following way:
  \begin{center}
    $n(P)\; =\; fn(P)\cup bn(P)$
  \end{center}
\end{definition}



In a definition $A(x_{1}, \cdots, x_{n})=P$ we assume that $fn(P)\subseteq \{x_{1}, \cdots, x_{n}\}$. 

\begin{definition}\index{syntactic substitution}
  $P\{b/a\}$ is the syntactic substitution of name $b$ for a different name $a$ inside a $\pi$ calculus process, and it consists in replacing every free occurrences of $a$ with $b$. If $b$ is a bound name in $P$, in order to avoid name capture we perform an appropriate $\alpha$ conversion. $P\{b/a\}$ is defined in table \ref{syntacticsubstitution}
\end{definition}

  \begin{table}
    \begin{tabular}{l}
      \hline\\
	$0\{b/a\}\; =\; 0$
      \\\\
	$(\overline{x}y.Q)\{b/a\}\; =\; \overline{x}\{b/a\}y\{b/a\}.Q\{b/a\}$
      \\\\
	$(x(y).Q)\{b/a\}\; =\; x\{b/a\}(y).Q\{b/a\}$ if $y\neq a$ and $y\neq b$
      \\\\
	$(x(a).Q)\{b/a\}\; =\; x\{b/a\}(a).Q$
      \\\\
	$(x(b).Q)\{b/a\}\; =\; x\{b/a\}(c).((Q\{c/b\})\{b/a\})$ where $c\notin n(Q)$
      \\\\
	$(\tau.Q)\{b/a\}\; =\; \tau.Q\{b/a\}$
      \\\\
	$(A(x_{1},\cdots, x_{n}))\{b/a\}=\left\{
	  \begin{array}{ll}
		A
	      &
		if\; a\notin fn(A)
	    \\
		A_{\{b/a\}}\; where\; A_{\{b/a\}}=Q\{b/a\}\; and\; A\stackrel{def}{=}Q
	      &
		if\; a\in fn(A)
	  \end{array}\right.$
      \\\\
	$(Q+R)\{b/a\}\; =\; Q\{b/a\} + R\{b/a\}$
      \\\\
	$(Q|R)\{b/a\}\; =\; Q\{b/a\} | R\{b/a\}$
      \\\\
	$((\nu y)Q)\{b/a\}\; =\;(\nu y)Q\{b/a\}$ if $y\neq a$ and $y\neq b$
      \\\\
	$((\nu a)Q)\{b/a\}\; =\;(\nu a)Q$
      \\\\
	$((\nu b)Q)\{b/a\}\; =\;(\nu c)((Q\{c/b\})\{b/a\})$ where $c\notin n(Q)$ if $a\in fn(Q)$ 
      \\\\
	$((\nu b)Q)\{b/a\}\; =\;(\nu b)Q$ if $a\notin fn(Q)$
      \\\hline
    \end{tabular}
    \caption{Syntatic substitution}
    \label{syntacticsubstitution}
  \end{table}




\section{Structural congruence}

Structural congruences are a set of equations defining equality and congruence relations on process. They can be used in combination with an SOS semantic for languages. In some cases structural congruences help simplifying the SOS rules: for example they can capture inherent properties of composition operators(e.g. commutativity, associativity and zero element). Also, in process calculi, structural congruences let processes interact even in case they are not adjacent in the syntax. There is a possible trade off between what to include in the structural congruence and what to include in the transition rules: for example in the case of the commutativity of the sum operator. It is worth noticing that in most process calculi every structurally congruent processes should never be distinguished and thus any semantic must assign them the same behaviour.

\begin{definition}
  A \emph{change of bound names} in a process $P$ is the replacement of a subterm $x(z).Q$ of $P$ by $x(w).Q\{w/z\}$ or the replacement of a subterm $(\nu z)Q$ of $P$ by $(\nu w)Q\{w/z\}$ where in each case $w$ does not occur in $Q$.
\end{definition}

\begin{definition}
  Processes $P$ and $Q$ are \emph{$\alpha$ convertible} if $Q$ can be obtained from $P$ by a finite number of changes of bound names. If $P$ and $Q$ are $\alpha$ convertible we write $P\stackrel{\alpha}{=}Q$
\end{definition}


\begin{definition}\index{context}
  A \emph{context} $C[\cdot]$ is a process with a placeholder. If $C[\cdot]$ is a context and we replace the placeholder with $P$, than we obtain $C[P]$. In doing so, we make no $\alpha$ conversions.
\end{definition}


\begin{definition}\index{congruence}
  A \emph{congruence} is a binary relation on processes such that:
  \begin{itemize}
    \item 
      $S$ is an equivalence relation
    \item 
      $S$ is preserved by substitution in contexts: for each pair of processes $(P, Q)$ and for each context $C[\cdot]$
      \begin{center}
	$(P,Q)\in S\; \Rightarrow\; (C[P], C[Q])\in S$
      \end{center}
  \end{itemize}
\end{definition}

% \begin{definition}\label{congruenza strutturale}
%   As stated in \cite{mousavireniers}, a \emph{structural congruence} is the minimal congruence on processes that satisify the following property:
% \end{definition}

\begin{definition}\index{structural congruence}
  We define a \emph{structural congruence $\equiv$} as the smallest congruence on processes that satisfies the axioms in table \ref{structuralcongrunce}
  \begin{table}
    \begin{tabular}{lll}
      \hline\\
	SC-ALP&$\begin{array}{c}P \stackrel{\alpha}{=} Q\\\overline{P\equiv Q}\end{array}$&$\alpha$ conversion
      \\\\
	\multicolumn{3}{l}{abelian monoid laws for sum:}
      \\
	SC-SUM-ASC& $M_{1}+(M_{2}+M_{3})\equiv (M_{1}+M_{2})+M_{3}$ &associativity
      \\
	SC-SUM-COM& $M_{1}+M_{2}\equiv M_{2}+M_{1}$ &commutativity
      \\
	SC-SUM-INC& $M+0\equiv M$&zero element
      \\\\
	\multicolumn{3}{l}{abelian monoid laws for parallel:}
      \\
	SC-COM-ASC& $P_{1}|(P_{2}|P_{3})\equiv (P_{1}|P_{2})|P_{3}$ &associativity
      \\
	SC-COM-COM& $P_{1}|P_{2}\equiv P_{2}|P_{1}$ &commutativity
      \\
	SC-COM-INC& $P|0\equiv P$&zero element
      \\\\
	\multicolumn{3}{l}{scope extension laws:}
      \\
	SC-RES& $(\nu z) (\nu w) P \equiv (\nu w) (\nu z) P$ &
      \\
	SC-RES-INC& $(\nu z) 0 \equiv 0$ &
      \\
	SC-RES-COM& $(\nu z) (P_{1}|P_{2}) \equiv P_{1}|(\nu z) P_{2}$ if $z\notin fn(P_{1})$&
      \\
	SC-RES-SUM& $(\nu z) (P_{1}+P_{2}) \equiv P_{1}+(\nu z) P_{2}$ if $z\notin fn(P_{1})$&
      \\\\
	\multicolumn{3}{l}{unfolding law:}
      \\
	SC-IDE&$A(\tilde{y})\equiv P\{\tilde{y}/\tilde{x}\}$&if $A(\tilde{x})\stackrel{def}{=}P$
      \\\hline
    \end{tabular}
    \caption{Structural congruence axioms}
    \label{structuralcongrunce}
  \end{table}
\end{definition}

We can make some clarification on the axioms of the structural congruence:
\begin{description}
  \item[$unfolding$] 
    this just helps replace an identifier by its definition, with the appropriate parameter instantiation. The alternative is to use an appropriate SOS rule: 
    \begin{center}
	  \bf{Cns}
	  \begin{tabular}{c}
	      $A(\tilde{x}) \stackrel{def}{=} P\; P\{\tilde{y}/\tilde{x}\} \xrightarrow{\alpha} P^{'}$
	    \\\hline
	      $A(\tilde{y}) \xrightarrow{\alpha} P^{'}$
	  \end{tabular}
    \end{center}
  \item[$\alpha\; conversion$]
    is the $\alpha$ conversion, i.e., the choice of bound names, it identifies agents like $x(y).\overline{z}y$ and $x(w).\overline{z}w$. In the semantic of pi calculus we can use the structural congruence with the rule SC-ALP or the we can embed the $\alpha$ conversion in the SOS rules. 
    In the early case the rule for input takes care of $\alpha$ conversion, whether in the late case the rule for communication is in charge for $\alpha$ conversion.
    But this works only for one binder: the input prefix. 
  \item[$abelian\; monoidal\; properties\; of\; some\; operators$]
    We can deal with associativity and commutativity properties of sum and parallel composition by using SOS rules or by axiom of the structural congruence. For example the commutativity of the sum can be expressed by the following two rules:
    \begin{center}
      \begin{tabular}{cc}
	\bf{Sum-L}
	  \begin{tabular}{c}
	    $P \xrightarrow{\alpha} P^{'}$\\
	    \hline
	    $P+Q \xrightarrow{\alpha} P^{'}$
	  \end{tabular}
	 &
	 \bf{Sum-R}
	   \begin{tabular}{c}
	    $Q \xrightarrow{\alpha} Q^{'}$\\
	    \hline
	    $P+Q \xrightarrow{\alpha} Q^{'}$
	   \end{tabular}
      \end{tabular}
    \end{center}
  or by the following rule and axiom:
    \begin{center}
      \begin{tabular}{cc}
	\bf{Sum}
	  \begin{tabular}{c}
	    $P \xrightarrow{\alpha} P^{'}$\\
	    \hline
	    $P+Q \xrightarrow{\alpha} P^{'}$
	  \end{tabular}
	 &
	 \bf{SC-SUM}
	   \begin{tabular}{c}
	    $P+Q \equiv Q+P$
	   \end{tabular}
      \end{tabular}
    \end{center}
    and the rule $Str$
  \item[$scope\; extension\; laws$]
    We can use this scope extension laws or the rules $Opn$ and $Cls$ to deal with the scope extension.
\end{description}

\section{Operational semantic}
\subsection{Early semantic without structural congruence}


The semantic of a $\pi$ calculus process is a labeled transition system such that:
\begin{itemize}
  \item 
    the nodes are $\pi$ calculus process. The set of node is $\mathbb{P}$
  \item
    the actions can be:
    \begin{itemize}
      \item unbound input $xy$
      \item unbound output $\overline{x}y$
      \item the silent action $\tau$
      \item bound output $\overline{x}(y)$
    \end{itemize}
    The set of actions is $\mathbb{A}$, we use $\alpha$ to range over the set of actions.
  \item
    the transition relations is $\rightarrow\subseteq \mathbb{P}\times \mathbb{A}\times \mathbb{P}$
\end{itemize}
In the following section we present the early semantic without structural congruence and without $alpha$ conversion. We call this semantic early because in the rule $ECom$
\begin{center}
  \begin{tabular}{c}
    $P \xrightarrow{xy} P^{'}\;\; Q\xrightarrow{\overline{x}y} Q^{'}$\\
    \hline
    $P|Q \xrightarrow{\tau} P^{'}|Q^{'}$
  \end{tabular}
\end{center}
there is no substitution, instead the substitution occurres at an early point in the inference of this translation, namely during the inference of the input action. 

\begin{definition}\index{transition relation! early! without structural congruence}
  The \emph{early transition relation} $\rightarrow\subseteq \mathbb{P}\times \mathbb{A} \times \mathbb{P}$ is the smallest relation induced by the rules in table \ref{transitionrelationearlywithoutstructuralcongruence}.

  \begin{table}
    \begin{tabular}{ll}  
      \hline\\
	  \bf{Out}
	  \begin{tabular}{c}
	      $\;\;$
	    \\\hline
	      $\overline{x}y.P \xrightarrow{\overline{x}y} P$
	  \end{tabular}
	&
	  \bf{EInp}
	  \begin{tabular}{c}
	    \\\hline
	      $x(y).P \xrightarrow{xz} P\{z/y\}$
	  \end{tabular}
      \\\\
	  \bf{Par-L}
	  \begin{tabular}{c}
	      $P \xrightarrow{\alpha} P^{'}\;\; bn(\alpha)\cap fn(Q)=\emptyset$
	    \\\hline
	      $P|Q \xrightarrow{\alpha} P^{'}|Q$
	  \end{tabular}
	&
	  \bf{Par-R}
	  \begin{tabular}{c}
	      $Q \xrightarrow{\alpha} Q^{'}\;\; bn(\alpha)\cap fn(Q)=\emptyset$
	    \\\hline
	      $P|Q \xrightarrow{\alpha} P|Q^{'}$
	  \end{tabular}
      \\\\
	  \bf{Sum-L}
	  \begin{tabular}{c}
	      $P \xrightarrow{\alpha} P^{'}$
	    \\\hline
	      $P+Q \xrightarrow{\alpha} P^{'}$
	  \end{tabular}
	&
	  \bf{Sum-R}
	  \begin{tabular}{c}
	      $Q \xrightarrow{\alpha} Q^{'}$
	    \\\hline
	      $P+Q \xrightarrow{\alpha} Q^{'}$
	    \end{tabular}
      \\\\
	  \bf{Tau}
	  \begin{tabular}{c}
	      $\;\;$
	    \\\hline
	      $\tau.P \xrightarrow{\tau} P$
	  \end{tabular}
	&
	  \bf{Res}
	  \begin{tabular}{c}
	      $P \xrightarrow{\alpha} P^{'}\;\; z\notin n(\alpha)$
	    \\\hline
	      $(\nu z) P \xrightarrow{\alpha} (\nu z) P^{'}$
	  \end{tabular}
      \\\\
	  \bf{EComR}
	  \begin{tabular}{c}
	      $P \xrightarrow{\overline{x}y} P^{'}\;\; Q\xrightarrow{xy} Q^{'}$
	    \\\hline
	      $P|Q \xrightarrow{\tau} P^{'}|Q^{'}$
	  \end{tabular}
	&
	  \bf{EComL}
	  \begin{tabular}{c}
	      $P \xrightarrow{xy} P^{'}\;\; Q\xrightarrow{\overline{x}y} Q^{'}$
	    \\\hline
	      $P|Q \xrightarrow{\tau} P^{'}|Q^{'}$
	  \end{tabular}
      \\\\
	    \bf{ClsL}
	    \begin{tabular}{c}
		$P \xrightarrow{\overline{x}(z)} P^{'}$  
		$Q \xrightarrow{xz} Q^{'}$ 
		$z\notin fn(Q)$
	      \\\hline
		$P|Q \xrightarrow{\tau} (\nu z)(P^{'}|Q^{'})$
	    \end{tabular}
	&
	    \bf{ClsR}
	    \begin{tabular}{c}
		$P \xrightarrow{xz} P^{'}$  
		$Q \xrightarrow{\overline{x}(z)} Q^{'}$ 
		$z\notin fn(P)$
	      \\\hline
		$P|Q \xrightarrow{\tau} (\nu z)(P^{'}|Q^{'})$
	    \end{tabular}
      \\\\
	  \bf{Cns}
	  \begin{tabular}{c}
	      $A(\tilde{x}) \stackrel{def}{=} P\; P\{\tilde{y}/\tilde{x}\} \xrightarrow{\alpha} P^{'}$
	    \\\hline
	      $A(\tilde{y}) \xrightarrow{\alpha} P^{'}$
	  \end{tabular}
	&
	  \bf{Opn}
	  \begin{tabular}{c}
	      $P \;\xrightarrow{\overline{x}z} P^{'}\;\; z\neq x$
	    \\\hline
	      $(\nu z) P \;\xrightarrow{\overline{x}(z)} P^{'}$
	  \end{tabular}
      \\\hline
    \end{tabular}
    \caption{Early transition relation without structural congruence}
    \label{transitionrelationearlywithoutstructuralcongruence}
  \end{table}
\end{definition}

\begin{example}
  We show now an example of the so called scope extrusion, in particular we prove that
  \begin{center}
    $a(x).P\; |\; (\nu b)\overline{a}b.Q\; \xrightarrow{\tau}\; (\nu b) (P\{b/x\}\; |\; Q)$
  \end{center}
  where we suppose that $b\notin fn(P)$. In this example the scope of $(\nu b)$ moves from the right hand component to the left hand.
  \[
    \inferrule* [left=CloseR] {
	\inferrule* [left=Einp] {
	}{
	  a(x).P\; \xrightarrow{ab} P\{b/x\}
	}
      \\
	\inferrule* [left=Opn] {
	    \inferrule* [left=Out]{
	    }{
	      \overline{a}b.Q\; \xrightarrow{\overline{a}b} Q
	    }
	  \\
	    a\neq b
	}{
	  (\nu b)\overline{a}b.Q\; \xrightarrow{\overline{a}(b)} Q
	}
      \\
	b\notin fn((\nu b)\overline{a}b.Q)
    }{
      a(x).P\; |\; (\nu b)\overline{a}b.Q\; \xrightarrow{\tau}\; (\nu b) (P\{b/x\}\; |\; Q)
    }
  \]

\end{example}


\begin{example}
    We want to prove now that:
    \begin{center}
      $((\nu b) a(x).P)\; |\; \overline{a}b.Q\; \xrightarrow{\tau}\; (\nu c) (P\{c/b\}\{b/x\}\; |\; Q)$
    \end{center}
    where $c\notin n(P)$
%      \[
%  	\inferrule* [left=ECloseL] {
%  	    \inferrule* [left=Res] {
%  	      \inferrule* [left=EInp] {
%  	      }{
%  		a(x).P\; \xrightarrow{a ?}\;  P\{\}
%  	      }
%  	    }{
%  	      (\nu b) a(x).P\; \xrightarrow{a ?}\; (\nu b) P\{\}
%  	    }
%  	  \\
%  	    \inferrule* [left=Out] {
%  	    }{
%  	      \overline{a}b.Q\; \xrightarrow{\overline{a}b}\; Q
%  	    }
%  	  \\
%  	    b\notin fn(P)
%  	}{
%  	  ((\nu b) a(x).P)\; |\; \overline{a}b.Q\; \xrightarrow{\tau}\; (\nu c) (P\{c/b\}\{b/x\}\; |\; Q)
%  	}
%      \]
  come faccio? devo aggiungere la regola $\bf{Alpha}$?
\end{example}


% \begin{example}
%   Now we prove that
%   \[
%     \inferrule* [left=Com]{
% 	\overline{a}x.c(x).0|b(x).0\;
% 	  \xrightarrow{\overline{a}x}\;
% 	      c(x).0|b(x).0
%       \\
% 	a(x).0|\overline{b}x.\overline{c}x.0\;
% 	  \xrightarrow{ax}\;
% 	    0|\overline{b}x.\overline{c}x.0
%     }{
%        (\overline{a}x.c(x).0|b(x).0)|(a(x).0|\overline{b}x.\overline{c}x.0)\; 
%  	\xrightarrow{\tau}\; 
%  	  (c(x).0|b(x).0)|(0|\overline{b}x.\overline{c}x.0)
% %        (\overline{a}x.c(x).0|b(x).0)|(a(x).0|\overline{b}x.\overline{c}x.0)\; 
% %  	\xrightarrow{\tau}\; 
% %  	  (0|0)|(0|0)
%     }
%   \]
%   
% \end{example}



\subsection{Early semantic with structural congruence}

\begin{definition}\index{transition relation! pi! early! with structural congruence}
  The \emph{early transition relation with structural congruence} $\rightarrow\subseteq \mathbb{P}\times \mathbb{A} \times \mathbb{P}$ is the smallest relation induced by the rules in table \ref{earlysemanticwithstructuralcongruence}.

  \begin{table}
    \begin{tabular}{lll}
      \hline\\
	  \bf{Out}
	  \begin{tabular}{c}
	    \hline
	    $\overline{x}y.P \xrightarrow{\overline{x}y} P$
	  \end{tabular}
	  &
	  \bf{EInp}
	  \begin{tabular}{c}
	    \hline
	    $x(z).P \xrightarrow{xy} P\{y/z\}$
	  \end{tabular}
	  &
	  \bf{Par}
	  \begin{tabular}{c}
	    $P \xrightarrow{\alpha} P^{'}\;\; bn(\alpha)\cap fn(Q)=\emptyset$\\
	    \hline
	    $P|Q \xrightarrow{\alpha} P^{'}|Q$
	  \end{tabular}
      \\\\
	  \bf{Sum}
	  \begin{tabular}{c}
	    $P \xrightarrow{\alpha} P^{'}$\\
	    \hline
	    $P+Q \xrightarrow{\alpha} P^{'}$
	  \end{tabular}
	  &
	    \bf{ECom}
	    \begin{tabular}{c}
	      $P \xrightarrow{xy} P^{'}\;\; Q\xrightarrow{\overline{x}y} Q^{'}$\\
	      \hline
	      $P|Q \xrightarrow{\tau} P^{'}|Q^{'}$
	    \end{tabular}
	  &
	  \bf{Res}
	  \begin{tabular}{c}
	    $P \xrightarrow{\alpha} P^{'}\;\; z\notin n(\alpha)$\\
	    \hline
	    $(\nu z) P \xrightarrow{\alpha} (\nu z) P^{'}$
	  \end{tabular}
      \\\\
	  \bf{Tau}
	  \begin{tabular}{c}
	    \hline
	    $\tau.P \xrightarrow{\tau} P$
	  \end{tabular}
	  &
	  \bf{Opn}
	  \begin{tabular}{c}
	    $P \xrightarrow{\overline{x}z} P^{'}\;\; z\neq x$\\
	    \hline
	    $(\nu z) P \xrightarrow{\overline{x}(z)} P^{'}$
	  \end{tabular}
	  &
	  \bf{Str}
	  \begin{tabular}{c}
	    $P\equiv P^{'}\;\; P\xrightarrow{\alpha} Q\;\; Q\equiv Q^{'}$\\
	    \hline
	    $P^{'} \xrightarrow{\alpha} Q^{'}$
	  \end{tabular}
      \\\hline
    \end{tabular}
    \caption{Early semantic with structural congruence}
    \label{earlysemanticwithstructuralcongruence}
  \end{table}
\end{definition}


\begin{example}
  We prove now that
  \begin{center}
    $a(x).P\; |\; (\nu b)\overline{a}b.Q\; \xrightarrow{\tau}\; (\nu b)(P\{b/x\}\; |\; Q)$
  \end{center}
  where $b\notin fn(P)$.
  This follows from
  \[
    a(x).P\; |\; (\nu b)\overline{a}b.Q\; \equiv\; (\nu b)(a(x).P\; |\; \overline{a}b.Q)
  \]
  and
  \[
    (\nu b)(a(x).P\; |\; \overline{a}b.Q) \xrightarrow{\tau} (\nu b)(P\{b/x\}\; |\; Q)
  \]
  with the rule $Str$. We can prove the last transition in the following way:
  \[
    \inferrule* [left=Res] {
      \inferrule* [left=Com] {
	  \inferrule* [left=EInp] {
	  }{
	    a(x).P\; \xrightarrow{ab}\; P\{b/x\}
	  }
	\\
	  \inferrule* [left=Out] {
	  }{
	    \overline{a}b.Q\; \xrightarrow{\overline{a}b}\; Q
	  }
      }{
	a(x).P\; |\; \overline{a}b.Q\; \xrightarrow{\tau}\; P\{b/x\}\; |\; Q
      }
    }{
      (\nu b)(a(x).P\; |\; \overline{a}b.Q)\; \xrightarrow{\tau}\; (\nu b)(P\{b/x\}\; |\; Q)
    }
  \]

\end{example}

\begin{example}
    We want to prove now that:
    \begin{center}
      $((\nu b) a(x).P)\; |\; \overline{a}b.Q\; \xrightarrow{\tau}\; (\nu c) (P\{c/b\}\{b/x\}\; |\; Q)$
    \end{center}
    where the name $c$ is not in the free names of $Q$. We can exploit the structural congruence and get that
    \[
      ((\nu b) a(x).P) | \overline{a}b.Q\; \equiv\; (\nu c) (a(x).(P\{c/b\}) | \overline{a}b.Q)     
    \]
    then we have
    \[
	\inferrule* [left=Res] {
	  \inferrule* [left=Com]{
	      \inferrule* [left=EInp]{
	      }{
		a(x).P\{c/b\}\; \xrightarrow{ab}\; P\{c/b\}\{b/x\}
	      }
	    \\
	      \inferrule* [left=Out]{
	      }{
		\overline{a}b.Q\; \xrightarrow{\overline{a}b}\; Q
	      }
	  }{
	      (a(x).(P\{c/b\}) | \overline{a}b.Q)\; \xrightarrow{\tau}\; (P\{c/b\}\{b/x\} | Q)
	  }
	}{
	  (\nu c) (a(x).(P\{c/b\}) | \overline{a}b.Q)\; \xrightarrow{\tau}\; (\nu c) (P\{c/b\}\{b/x\} | Q)
	}
    \]
    Now we just apply the rule $Str$ to prove the thesis.
\end{example}


\subsection{Late semantic without structural congruence}




In this case the set of actions $\mathbb{A}$ contains
\begin{itemize}
      \item bound input $x(y)$
      \item unbound output $\overline{x}y$
      \item the silent action $\tau$
      \item bound output $\overline{x}(y)$
\end{itemize}


\begin{definition}\index{transition relation! pi! late! without structural congruence}
  The \emph{late transition relation without structural congruence} $\rightarrow\subseteq \mathbb{P}\times \mathbb{A} \times \mathbb{P}$ is the smallest relation induced by the rules in table \ref{transitionrelationpilatewithoutstructuralcongruence}.
  \begin{table}
    \begin{tabular}{ll}
      \hline\\
	  \bf{LInp}
	  \begin{tabular}{c}
 	    $z\notin fn(P)$
	    \\\hline
 	    $x(y).P \xrightarrow{x(z)} P\{z/y\}$
	  \end{tabular}
	&
	  \bf{Res}
	  \begin{tabular}{c}
	    $P \xrightarrow{\alpha} P^{'}$ $z\notin n(\alpha)$
	      \\\hline
	    $(\nu z) P \xrightarrow{\alpha} (\nu z) P^{'}$
	  \end{tabular}    
      \\\\
	  \bf{Sum-L}
	  \begin{tabular}{c}
	      $P \xrightarrow{\alpha} P^{'}$
	    \\\hline
	      $P+Q \xrightarrow{\alpha} P^{'}$
	  \end{tabular}
	&
	  \bf{Sum-R}
	  \begin{tabular}{c}
	      $Q \xrightarrow{\alpha} Q^{'}$
	    \\\hline
	      $P+Q \xrightarrow{\alpha} Q^{'}$
	  \end{tabular}
      \\\\
	  \bf{Par-L}
	  \begin{tabular}{c}
	      $P \xrightarrow{\alpha} P^{'}\;\; bn(\alpha)\cap fn(Q)=\emptyset$
	    \\\hline
	      $P|Q \xrightarrow{\alpha} P^{'}|Q$
	  \end{tabular}
	&
	  \bf{Par-R}
	  \begin{tabular}{c}
	      $Q \xrightarrow{\alpha} Q^{'}\;\; bn(\alpha)\cap fn(Q)=\emptyset$
	    \\\hline
	      $P|Q \xrightarrow{\alpha} P|Q^{'}$
	  \end{tabular}
      \\\\
	  \bf{LCom}
	  \begin{tabular}{c}
	      $P \xrightarrow{x(y)} P^{'}\;\; Q\xrightarrow{\overline{x}(z)} Q^{'}$
	    \\\hline
	      $P|Q \xrightarrow{\tau} P^{'}\{z/y\}|Q^{'}$
	  \end{tabular}	
	&
	  \bf{RCom}
	  \begin{tabular}{c}
	      $P \xrightarrow{\overline{x}(z)} P^{'}\;\; Q\xrightarrow{x(y)} Q^{'}$
	    \\\hline
	      $P|Q \xrightarrow{\tau} P^{'}|Q^{'}\{z/y\}$
	  \end{tabular}	
      \\\\
	  \bf{Opn}
	  \begin{tabular}{c}
	      $P \xrightarrow{\overline{x}z} P^{'}\;\; z\neq x$
	    \\\hline
	      $(\nu z) P \xrightarrow{\overline{x}(z)} P^{'}$
	  \end{tabular}
	&
	  \bf{Out}
	  \begin{tabular}{c}
	    \hline
	    $\overline{x}y.P \xrightarrow{\overline{x}y} P$
	  \end{tabular}
      \\\\
	  \bf{CloseL}
	  \begin{tabular}{c}
	      $P\; \xrightarrow{\overline{x}(z)}\; P^{'}$  $Q \xrightarrow{xz} Q^{'}$ $z\notin fn(Q)$
	    \\\hline
	      $P|Q\; \xrightarrow{\tau}\; (\nu z)(P^{'}|Q^{'})$
	  \end{tabular}
	&
	  \bf{CloseR}
	  \begin{tabular}{c}
	      $P \xrightarrow{xz} P^{'}$  $Q \xrightarrow{\overline{x}(z)} Q^{'}$ $z\notin fn(P)$
	    \\\hline
	      $P|Q \xrightarrow{\tau} (\nu z)(P^{'}|Q^{'})$
	  \end{tabular}
      \\\\
	  \bf{Tau}
	  \begin{tabular}{c}
	    \hline
	      $\tau.P \xrightarrow{\tau} P$
	  \end{tabular}
	&
	  \bf{Cns}
	  \begin{tabular}{c}
	    $A(\tilde{x}) \stackrel{def}{=} P\; P\{\tilde{y}/\tilde{x}\} \xrightarrow{\alpha} P^{'}$
	      \\\hline
	    $A(\tilde{y}) \xrightarrow{\alpha} P^{'}$
	  \end{tabular}
      \\\hline
    \end{tabular}
    \caption{Late semantic without structural congruence}
    \label{transitionrelationpilatewithoutstructuralcongruence}
  \end{table}
\end{definition}



\subsection{Late semantic with structural congruence}

\begin{definition}\index{transition relation! pi! late! with structural congruence}
  The \emph{late transition relation with structural congruence} $\rightarrow\subseteq \mathbb{P}\times \mathbb{A} \times \mathbb{P}$ is the smallest relation induced by the rules in table \ref{latewith}.
  \begin{table}
    \begin{tabular}{ll}
	\hline\\
	\bf{Prf}
	\begin{tabular}{c}
	  \hline
	  $\alpha.P \xrightarrow{\alpha} P$
	\end{tabular}
      &
	\bf{Sum}
	\begin{tabular}{c}
	    $P \xrightarrow{\alpha} P^{'}$
	  \\\hline
	    $P+Q \xrightarrow{\alpha} P^{'}$
	\end{tabular}
    \\\\
	\bf{Par}
	\begin{tabular}{c}
	    $P \xrightarrow{\alpha} P^{'}\;\; bn(\alpha)\cap fn(Q)=\emptyset$
	  \\\hline
	    $P|Q \xrightarrow{\alpha} P^{'}|Q$
	\end{tabular}
      &
	\bf{Res}
	\begin{tabular}{c}
	    $P \xrightarrow{\alpha} P^{'}$ $z\notin n(\alpha)$
	  \\\hline
	    $(\nu z) P \xrightarrow{\alpha} (\nu z) P^{'}$
	\end{tabular}
    \\\\    
	\bf{LCom}
	\begin{tabular}{c}
	    $P \xrightarrow{x(y)} P^{'}\;\; Q\xrightarrow{\overline{x}z} Q^{'}$
	  \\\hline
	  $P|Q \xrightarrow{\tau} P^{'}\{z/y\}|Q^{'}$
	\end{tabular}
      &
	\bf{Str}
	\begin{tabular}{c}
	    $P\equiv P^{'}\;\; P\xrightarrow{\alpha} Q\;\; Q\equiv Q^{'}$
	  \\\hline
	    $P^{'} \xrightarrow{\alpha} Q^{'}$
	\end{tabular}
    \\\\
	\bf{Opn}
	\begin{tabular}{c}
	    $P \xrightarrow{\overline{x}z} P^{'}\;\; z\neq x$
	  \\\hline
	    $(\nu z) P \xrightarrow{\overline{x}(z)} P^{'}$
	\end{tabular}
      &
    \\\hline
    \end{tabular}
    \caption{Late semantic with structural congruence}
    \label{latewith}
  \end{table}
\end{definition}


\begin{example}
  We prove now that
  \begin{center}
    $a(x).P\; |\; (\nu b)\overline{a}b.Q\; \xrightarrow{\tau} P\{b/x\}\; |\; Q$
  \end{center}
  where $b\notin fn(P)$. This follows from
  \[
    a(x).P\; |\; (\nu b)\overline{a}b.Q\; \equiv\; (\nu b)(a(x).P\; |\; \overline{a}b.Q)
  \]
  and
  \[
    (\nu b)(a(x).P\; |\; \overline{a}b.Q) \xrightarrow{\tau} (\nu b)(P\{b/x\}\; |\; Q)
  \]
  with the rule $Str$. We can prove the last transition in the following way:
  \[
    \inferrule* [left=Res] {
	\inferrule* [left=LCom] {
	    \inferrule* [left=LInp] {
	      b\notin fn(P)
	    }{
	      a(x).P\; \xrightarrow{ab}\; P\{b/x\}
	    }
	  \\
	    \inferrule* [left=Out] {
	    }{
	      \overline{a}b.Q\; \xrightarrow{\overline{a}b}\; Q
	    }
	}{
	  a(x).P\; |\; \overline{a}b.Q\; \xrightarrow{\tau}\; P\{b/x\}\; |\; Q
	}
      \\
	b\notin n(\tau)
    }{
      (\nu b)(a(x).P\; |\; \overline{a}b.Q)\; \xrightarrow{\tau}\; (\nu b)(P\{b/x\}\; |\; Q)
    }
  \]

\end{example}

\begin{example}
    We want to prove now that:
    \begin{center}
      $((\nu b) a(x).P)\; |\; \overline{a}b.Q\; \xrightarrow{\tau}\; (\nu c) (P\{c/b\}\{b/x\}\; |\; Q)$
    \end{center}
    where the name $c$ is not in the free names of $Q$ and is not in the names of $P$. We can exploit the structural congruence and get that
    \[
      ((\nu b) a(x).P) | \overline{a}b.Q\; \equiv\; (\nu c) (a(x).(P\{c/b\}) | \overline{a}b.Q)     
    \]
    then we have
    \[
	\inferrule* [left=Res] {
	    \inferrule* [left=LCom]{
		\inferrule* [left=LInp]{
		  b\notin fn(P\{c/b\})
		}{
		  a(x).P\{c/b\}\; \xrightarrow{ab}\; P\{c/b\}\{b/x\}
		}
	      \\
		\inferrule* [left=Out]{
		}{
		  \overline{a}b.Q\; \xrightarrow{\overline{a}b}\; Q
		}
	    }{
	      (a(x).(P\{c/b\}) | \overline{a}b.Q)\; \xrightarrow{\tau}\; (P\{c/b\}\{b/x\} | Q)
	    }
	  \\
	    c\notin n(\tau)
	}{
	  (\nu c) (a(x).(P\{c/b\}) | \overline{a}b.Q)\; \xrightarrow{\tau}\; (\nu c) (P\{c/b\}\{b/x\} | Q)
	}
    \]
    Now we just apply the rule $Str$ to prove the thesis.
\end{example}


\section{Bisimilarity and Congruence}

We present here some behavioural equivalences and some of their properties. 

\subsection{Bisimilarity}
In the following we will use the phrase $bn(\alpha)$ is fresh in a definition to mean that the name in $bn(\alpha)$, if any, is different from any free name occurring in any of the agents in the definition. In this subsection the transition relation is given by the late semantic with structural congruence.

\begin{definition}
  A \emph{strong (late) bisimulation} is a symmetric binary relation $\mathbb{R}$ on agents satisfying the following: $P\mathbb{R} Q$ and $P\; \xrightarrow{\alpha}_{E}\; P^{'}$ where $bn(\alpha)$ is fresh implies that
  \begin{itemize}
    \item
      if $\alpha=a(x)$ then $\exists Q^{'}: Q\xrightarrow{a(x)}Q^{'}\; \wedge\; \forall u:\; P^{'}\{u/x\}\mathbb{R}Q^{'}\{u/x\}$
    \item
      if $\alpha$ is not an input the $\exists Q^{'}: Q\xrightarrow{\alpha}Q^{'}\; \wedge\; P^{'}\mathbb{R}Q^{'}$
  \end{itemize}
  $P$ and $Q$ are strongly bisimilar, written $P\; \dot{\sim}\; Q$, if they are related by a bisimulation. 
\end{definition}

The union of all bisimulation $\dot{\sim}$ is a bisimulation. If two process are structurally congruent then because of the rule $Str$ they are also strong bisimilar.

\begin{example}
  Two strongly bisimilar processes are the following:
  \[
    a(x).0|\overline{b}x.0\; \dot{\sim}\; a(x).\overline{b}x.0 + \overline{b}x.a(x).0
  \]
  and the bisimulation(without showing the simmetric part) is  the following:
  \[
    \{(a(x).0|\overline{b}x.0, a(x).\overline{b}x.0 + \overline{b}x.a(x).0),(a(x).0|0,a(x).0), (0|0,0|0)\} \cup \{(0|\overline{b}x.0,\overline{b}x.0)|x\in \mathbb{N}\} 
  \]

  If we apply the substitution $\{a/b\}$ to each process then they are not strongly bisimilar anymore because $(a(x).0|\overline{b}x.0)\{a/b\}$ is $a(x).0|\overline{a}x.0$ and this process can perform an invisible action whether $(a(x).\overline{b}x.0 + \overline{b}x.a(x).0)\{a/b\}$ cannot. This shows that strong bisimulation is not closed under substitution.
\end{example}

\begin{proposition}
  If $P \dot{\sim} Q$ and $\sigma$ is injective then $P\sigma \dot{\sim} Q\sigma$
%   \begin{proof}
%     We have to establish that transitions are preserved by injective substitution, i.e., that for injective $\sigma$ 
%     \[
%       P\xrightarrow{\alpha}P^{'}\; \Rightarrow\; P\sigma\xrightarrow{\alpha\sigma}P^{'}\sigma
%     \]
%     by induction on the inference of $P\xrightarrow{\alpha}P^{'}$. For this purpose we consider the late semantic with structural congruence:
%     %The last rule of a derivation of $P\xrightarrow{\alpha}P^{'}$ can be:
%     \begin{description}
%       \item[$Pref$] 		
% 	An application of the rule pref let us prove that $\alpha\sigma.P\sigma\xrightarrow{\alpha\sigma}P\sigma$
%       \item[$Str$]
% 	The premises of the rule tell us that: $P\xrightarrow{\alpha}Q$, $P^{'}\equiv P$ and $Q\equiv Q^{'}$. We apply the inductive hypothesis to the first premise and get $P\sigma\xrightarrow{\alpha\sigma}Q\sigma$. From the other two premises we get that $P^{'}\sigma\equiv P\sigma$ and $Q\sigma\equiv Q^{'}\sigma$. We should prove this separately. So applying the rule $Str$ we get the result $P^{'}\sigma\xrightarrow{\alpha\sigma}Q^{'}\sigma$.
%       \item[$Sum$]
% 	
%       \item[$Par$]
%       \item[$Com$]
%       \item[$Res$]
%       \item[$Opn$]
%     \end{description}
%   \end{proof}
\end{proposition}

\begin{proposition}
  $\dot{\sim}$ is an equivalence
\end{proposition}

\begin{proposition}
  $\dot{\sim}$ is preserved by all operators except input prefix
\end{proposition}


\subsection{Congruence}

\begin{definition}\index{congruence! strong}
  We say that two agents $P$ and $Q$ are \emph{strongly congruent}, written $P\sim Q$ if
  \begin{center}
    $P\sigma \dot{\sim} Q\sigma$ for all substitution $\sigma$    
  \end{center}
\end{definition}

\begin{proposition}
  Strong congruence is the largest congruence in bisimilarity.
\end{proposition}

\subsection{Variants of Bisimilarity}

We define a bisimulation for the early semantic with structural congruence, for clarity when referring to the early semantic we index the transition with $ _{E}$. 
\begin{definition}\index{bisimulation! strong! early! with early semantic}
  A \emph{strong early bisimulation with early semantic} is a symmetric binary relation $\mathbb{R}$ on agents satisfying the following: $P\mathbb{R} Q$ and $P\; \xrightarrow{\alpha}_{E}\; P^{'}$ where $bn(\alpha)$ is fresh implies that
  \begin{center}
    $\exists Q^{'}: Q\xrightarrow{\alpha}Q^{'}\; \wedge\; P^{'}\mathbb{R}Q^{'}$
  \end{center}
  $P$ and $Q$ are strongly early bisimilar, written $P\; \dot{\sim}_{E}\; Q$, if they are related by an early bisimulation.
\end{definition}

\begin{definition}\index{bisimulation! strong! early! with late semantic}
  A \emph{strong early bisimulation with late semantic} is a symmetric binary relation $\mathbb{R}$ on agents satisfying the following: $P\mathbb{R} Q$ and $P\; \xrightarrow{\alpha}\; P^{'}$ where $bn(\alpha)$ is fresh implies that
  \begin{itemize}
    \item
      if $\alpha=a(x)$ then $\forall u\; \exists Q^{'}:\;\; Q\xrightarrow{a(x)}Q^{'}\; \wedge\; P^{'}\{u/x\}\mathbb{R}Q^{'}\{u/x\}$
    \item
      if $\alpha$ is not an input then $\exists Q^{'}:\;\; Q\xrightarrow{\alpha}Q^{'}\; \wedge\; P^{'}\mathbb{R}Q^{'}$
  \end{itemize}
\end{definition}

\begin{proposition}
  Early bisimilarity is preserved by all operators except input prefix. 
\end{proposition}


\begin{definition}\index{congruence! early}
  The \emph{early congruence} $\sim_{E}$ is defined by
  \begin{center}
    $P\sim_{E} Q$ if $\forall \sigma\; P\sigma \dot{\sim}_{E} Q\sigma$
  \end{center}
  where $\sigma$ is a substitution.
\end{definition}

\begin{proposition}
  The early congruence is the largest congruence in $\dot{\sim}_{E}$.  
\end{proposition}

In the following definition we consider a subcalculus without restriction. 
\begin{definition}\index{bisimulation! strong! open! early}
  A \emph{strong open bisimulation} is a symmetric binary relation $\mathbb{R}$ on agents satisfying the following for all substitutions $\sigma$: $P\mathbb{R} Q$ and $P\sigma\; \xrightarrow{\alpha}\; P^{'}$ where $bn(\alpha)$ is fresh implies that
  \begin{center}
    $\exists Q^{'}:\;\; Q\sigma\xrightarrow{\alpha}Q^{'}\; \wedge\; P^{'}\mathbb{R}Q^{'}$
  \end{center}
  $P$ and $Q$ are strongly open bisimilar, written $P\; \dot{\sim}_{O}\; Q$ if they are related by an open bisimulation.
\end{definition}

\begin{proposition}
  strong open bisimulation is also a late bisimulation, is closed under substitution, is an equivalence and a congruence
\end{proposition}



