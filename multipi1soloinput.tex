
\section{Syntax}

As we did whit $\pi$ calculus, we suppose that we have a countable set of names $\mathbb{N}$, ranged over by lower case letters $a,b, \cdots, z$. This names are used for communication channels and values. Furthermore we have a set of identifiers, ranged over by $A$. We represent the agents or processes by upper case letters $P,Q, \cdots $. A multi $\pi$ process, in addiction to the same actions of a $\pi$ process, can perform also a strong prefix input:
\begin{center}
  $\pi$ ::= $\overline{x}y$ | $x(z)$ | $\underline{x(y)}$ | $\tau$ 
\end{center}
The process are defined, just as original $\pi$ calculus, by the following grammar:
\begin{center}
  \begin{tabular}{l}
    $P,Q$ ::= $0$ | $\pi.P$ | $P|Q$ | $P+Q$ | $(\nu x) P$ | $A(y_{1}, \cdots, y_{n})$
  \end{tabular}
\end{center}
and they have the same intuitive meaning as for the $\pi$ calculus. The strong prefix input allows a process to make an atomic sequence of actions, so that more than one process can synchronize on this sequence. For the moment we allow the strong prefix to be on input names only. Also one can use the strong prefix only as an action prefixing for processes that can make at least a further action. 

Multi $\pi$ calculus is a conservative extension of the $\pi$ calculus in the sense that: any $\pi$ calculus process $p$ is also a multi $\pi$ calculus process and the semantic of $p$ according to the SOS rules of $\pi$ calculus is the same as the semantic of $p$ according to the SOS rules of multi $\pi$ calculus. 
We have to extend the following definition to deal with the strong prefix:
\begin{center}
  \begin{tabular}{ll}
	$B(\underline{x(y)}.Q, I) = \{y,\overline{y}\}\cup B(Q, I)$
      &
	$F(\underline{x(y)}.Q, I) = \{x,\overline{x}\}\cup (F(Q, I)-\{y,\overline{y}\})$
    \\
  \end{tabular}
\end{center}


In this setting two process cannot synchronize on a sequence of actions with length greater than one so we cannot have transactional synchronization but we can have multi-party synchronization.


\section{Operational semantic}

\subsection{Early operational semantic with structural congruence}

The semantic of a multi $\pi$ process is labeled transition system such that
\begin{itemize}
  \item 
    the nodes are multi $\pi$ calculus process. The set of node is $\mathbb{P}_{m}$
  \item
    the actions are multi $\pi$ calculus actions. The set of actions is $\mathbb{A}_{m}$, we use $\alpha, \alpha_{1}, \alpha_{2},\cdots $ to range over the set of actions, we use $\sigma, \sigma_{1}, \sigma_{2}, \cdots $ to range over the set $\mathbb{A}_{m}^{+} \cup \{\tau\}$.
  \item
    the transition relations is $\rightarrow\subseteq \mathbb{P}_{m}\times (\mathbb{A}_{m}^{+} \cup \{\tau\})\times \mathbb{P}_{m}$
\end{itemize}

In this case, a label can be a sequence of prefixes, whether in the original $\pi$ calculus a label can be only a prefix. We use the symbol $\cdot$ to denote the concatenation operator.

\begin{definition}
  The \emph{early transition relation with structural congruence} is the smallest relation induced by the rules in table \ref{multipisoloinputearlywith} where $inpSeq$ is a non empty sequence of input actions and $\sigma$ is a sequence of any action.
  \begin{table}
    \begin{tabular}{lll}
	  \hline\\
	  $\inferrule* [left=\bf{Out}]{
	  }{
	    \overline{x}y.P \xrightarrow{\overline{x}y} P
	  }$
	&
	  $\inferrule* [left=\bf{EInp}]{
	  }{
	    x(y).P \xrightarrow{xz} P\{z/y\}
	  }$
	&
	  $\inferrule* [left=\bf{Tau}]{
	  }{
	    \tau.P \xrightarrow{\tau} P
	  }$
      \\\\
	  $\inferrule* [left=\bf{SInpTau}]{
	      P\{y/z\} \xrightarrow{\tau} P^{'}
	  }{
	    \underline{x(z)}.P \xrightarrow{xy} P^{'}
	  }$
	&
	  $\inferrule* [left=\bf{SInp}]{
	      P\{y/z\} \xrightarrow{ab} P^{'}
% 	    \\
% 	      y\notin fn((\nu z) P)
	  }{
	    \underline{x(z)}.P \xrightarrow{xy \cdot ab} P^{'}
	  }$
	&
	  $\inferrule* [left=\bf{SInpSeq}]{
	      P\{y/z\} \xrightarrow{\sigma} P^{'}
	    \\
	      |\sigma|>1
% 	    \\
% 	      y\notin fn((\nu z) P)
	  }{
	    \underline{x(z)}.P \xrightarrow{xy \cdot \sigma} P^{'}
	  }$
      \\\\
	  $\inferrule* [left=\bf{Sum}]{
	    P \xrightarrow{\sigma} P^{'}
	  }{
	    P+Q \xrightarrow{\sigma} P^{'}
	  }$
	&
	  $\inferrule* [left=\bf{Cong}]{
	      P\equiv P^{'}
	    \\
	      P^{'} \xrightarrow{\alpha} Q
	  }{
	      P \xrightarrow{\alpha} Q
	  }$
	&
	  $\inferrule* [left=\bf{Res}]{
	      P \xrightarrow{\sigma} P^{'}
	    \\
	      z\notin n(\sigma)
	  }{
	    (\nu z) P \xrightarrow{\sigma} (\nu z) P^{'}
	  }$
      \\\\
	  $\inferrule* [left=\bf{Par}]{
	      P \xrightarrow{\sigma} P^{'}
	  }{
	      P|Q \xrightarrow{\sigma} P^{'}|Q
	  }$
	&
	  $\inferrule* [left=\bf{Opn}]{
	      P \xrightarrow{\overline{x}z} P^{'}
	    \\ 
	      z\neq x
	  }{
	      (\nu z)P \xrightarrow{\overline{x}(z)} P^{'}
	  }$
	&
	  $\inferrule* [left=\bf{ECom}]{
	      P \xrightarrow{xy} P^{'}
	    \\
	      Q \xrightarrow{\overline{x}y} Q^{'}
	  }{
	    P|Q \xrightarrow{\tau} P^{'}|Q^{'}
	  }$
      \\\\
	&
	&
	  $\inferrule* [left=\bf{EComSeq}]{
	      P \xrightarrow{xy\cdot \sigma} P^{'}
	    \\
	      Q \xrightarrow{\overline{x}y} Q^{'}
	  }{
	    P|Q \xrightarrow{\sigma} P^{'}|Q^{'}
	  }$
      \\\\
	&
	&
      \\\\\hline
    \end{tabular}
    \caption{Multi $\pi$ early semantic with structural congruence}
    \label{multipisoloinputearlywith}
  \end{table}
\end{definition}



\begin{example}Multi-party synchronization
  We show an example of a derivation of three processes that synchronize.
  \begin{center}
  $
      \inferrule* [left=\bf{EComSng}]{
	\underline{x(a)}.x(b).P|\overline{x}y.Q)
	  \xrightarrow{xz}
	    P\{y/a\}\{z/b\}|Q
	\\
	  \inferrule* [left=\bf{Out}]{
	  }{
	    \overline{x}z.R	
	      \xrightarrow{\overline{x}z} 
		R
	  }
      }{
	(\underline{x(a)}.x(b).P|\overline{x}y.Q)|\overline{x}z.R
	  \xrightarrow{\tau}
	    (P\{y/a\}\{z/b\}|Q)|R
      }
  $
  \end{center}
  
  \begin{center}
  $\inferrule* [left=\bf{EComSeq}]{
      \inferrule* [left=\bf{SInp}]{
	\inferrule* [left=\bf{EInp}]{
	}{
	  (x(b).P)\{y/a\} \xrightarrow{xz} P\{y/a\}\{z/b\}
	}
      }{
	\underline{x(a)}.(x(b).P) 
	  \xrightarrow{xy \cdot xz} 
	    P\{y/a\}\{z/b\}
      }
    \\
      \inferrule* [left=\bf{Out}]{
      }{
	\overline{x}y.Q \xrightarrow{\overline{x}y} Q
      }
  }{
	\underline{x(a)}.x(b).P|\overline{x}y.Q)
	  \xrightarrow{xz}
	    P\{y/a\}\{z/b\}|Q
  }$
  \end{center}

\end{example}

\begin{lemma}\label{lemmastrongsequence}
  If $P\xrightarrow{\sigma} Q$ then only one of the following cases hold: 
  \begin{itemize}
    \item 
      $|\sigma|=1$
    \item
      $|\sigma|>1$, the actions in $\sigma$ are input.
  \end{itemize}
\end{lemma}



\subsection{Late operational semantic with structural congruence}

\begin{definition}
  The \emph{late transition relation with structural congruence} is the smallest relation induced by the rules in table \ref{multipisoloinputlateywith}.
  \begin{table}
    \begin{tabular}{ll}
	\hline\\
     	  $\inferrule* [left=\bf{Pref}]{
	    \alpha not a strong prefix
	  }{
	    \alpha.P \xrightarrow{\alpha} P
	  }$
	&
	  $\inferrule* [left=\bf{LComSeq}]{
	      P \xrightarrow{x(y)\cdot \sigma} P^{'}
	    \\
	      Q\xrightarrow{\overline{x}z} Q^{'}
	    \\
	      z\notin fn(\sigma)\cup fn(P)
	  }{
	    P|Q \xrightarrow{\sigma\{z/y\}} P^{'}\{z/y\}|Q^{'}
	  }$
      \\\\
	  $\inferrule* [left=\bf{SInp}]{
	      P \xrightarrow{a(b)} P^{'}
	  }{
	    \underline{x(y)}.P \xrightarrow{x(y) \cdot a(b)} P^{'}
	  }$
	&
	  $\inferrule* [left=\bf{LCom}]{
	      P \xrightarrow{x(y)} P^{'}
	    \\
	      Q\xrightarrow{\overline{x}z} Q^{'}
	    \\
	      z\notin fn(P)
	  }{
	    P|Q \xrightarrow{\tau} P^{'}\{z/y\}|Q^{'}
	  }$
      \\\\
	  $\inferrule* [left=\bf{Sum}]{
	    P \xrightarrow{\sigma} P^{'}
	  }{
	    P+Q \xrightarrow{\sigma} P^{'}
	  }$
	&
	  $\inferrule* [left=\bf{Cong}]{
	      P\equiv P^{'}
	    \\
	      P^{'} \xrightarrow{\sigma} Q
	  }{
	      P \xrightarrow{\sigma} Q
	  }$
      \\\\
	  $\inferrule* [left=\bf{Res}]{
	      P \xrightarrow{\sigma} P^{'}
	    \\
	      z\notin n(\alpha)
	  }{
	    (\nu z) P \xrightarrow{\sigma} (\nu z) P^{'}
	  }$
	&
	  $\inferrule* [left=\bf{Par}]{
	      P \xrightarrow{\sigma} P^{'}
	    \\
	      bn(\sigma)\cup fn(Q)=\emptyset
	  }{
	    P|Q \xrightarrow{\sigma} P^{'}|Q
	  }$
      \\\\
	  $\inferrule* [left=\bf{Opn}]{
	      P \xrightarrow{\overline{x}z} P^{'}
	    \\ 
	      z\neq x
	  }{
	      (\nu z)P \xrightarrow{\overline{x}(z)} P^{'}
	  }$
	&
	  $\inferrule* [left=\bf{SInpSeq}]{
	      P \xrightarrow{\sigma} P^{'}
	    \\
	      |\sigma|>1
	  }{
	    \underline{x(y)}.P \xrightarrow{x(y) \cdot \sigma} P^{'}
	  }$
      \\\\
	  $\inferrule* [left=\bf{SInpTau}]{
	      P \xrightarrow{\tau} P^{'}
	  }{
	    \underline{x(y)}.P \xrightarrow{x(y)} P^{'}
	  }$
	&
      \\\hline
    \end{tabular}
    \caption{Multi $\pi$ late semantic with structural congruence}
    \label{multipisoloinputlateywith}
  \end{table}
\end{definition}

\begin{example}Multi-party synchronization
  We show an example of a derivation of three processes that synchronize with the late semantic. The three processes are $\underline{x(a)}.x(b).P$, $\overline{x}y.Q$ and $\overline{x}z.R$. We assume that:
  \begin{center}
      $a\notin fn(x(b))\cup fn (\underline{x(a)}.x(b).P)$
  \end{center}
  and
  \begin{center}
      $b\notin fn(\underline{x(a)}.x(b).P|\overline{x}y.Q)$
  \end{center}

  \begin{center}
  $
      \inferrule* [left=\bf{LCom}]{
	\underline{x(a)}.x(b).P|\overline{x}y.Q
	  \xrightarrow{x(b)}
	    P\{y/a\}|Q
	\\
	  \inferrule* [left=\bf{Pref}]{
	  }{
	    \overline{x}z.R	
	      \xrightarrow{\overline{x}z} 
		R
	  }
      }{
	(\underline{x(a)}.x(b).P|\overline{x}y.Q)|\overline{x}z.R
	  \xrightarrow{\tau}
	    (P\{y/a\}|Q)\{z/b\}|R
      }
  $
  \end{center}
  
  \begin{center}
  $\inferrule* [left=\bf{LComSeq}]{
      \inferrule* [left=\bf{SInp}]{
	\inferrule* [left=\bf{Pref}]{
	}{
	  x(b).P \xrightarrow{x(b)} P
	}
      }{
	\underline{x(a)}.x(b).P
	  \xrightarrow{x(a) \cdot x(b)} 
	    P
      }
    \\
      \inferrule* [left=\bf{Out}]{
      }{
	\overline{x}y.Q \xrightarrow{\overline{x}y} Q
      }
  }{
	\underline{x(a)}.x(b).P|\overline{x}y.Q)
	  \xrightarrow{x(b)}
	    P\{y/a\}|Q
  }$
  \end{center}

\end{example}



\subsection{Low level semantic}
This section contains the definition of an alternative semantic for multi $\pi$. First we define a low level version of the multi $\pi$ calculus(here with strong prefixing on input only), we call this language low multi $\pi$. The low multi $\pi$ is the multi $\pi$ enriched with a marked or intermediate process $*P$:
\begin{center}
   \begin{tabular}{l}
     $P,Q$ ::= $0$ | $\pi.P$ | $P|Q$ | $P+Q$ | $(\nu x) P$ | $A(x_{1}, \cdots, x_{n})$ | $*P$
   \\\\
     $\pi$ ::= $\overline{x}y$ | $x(z)$ | $\underline{x(y)}$ | $\tau$ 
   \end{tabular}
\end{center}
\begin{definition}
  The low level transition relation is the smallest relation induced by the rules in table \ref{lowleveltransitionrelationinput} in which $P$ stands for a process without mark, $L$ stands for a process with mark and $S$ can stand for both. 
  \begin{table}
    \begin{tabular}{lll}
      \hline\\
	  $\inferrule* [left=\bf{Out}]{
	  }{
	    \overline{x}y.P \stackrel{\overline{x}y}{\longmapsto} P
	  }$
	  &
	  $\inferrule* [left=\bf{EInp}]{
	  }{
	    x(y).P \stackrel{xz}{\longmapsto} P\{z/y\}
	  }$
	  &
	  $\inferrule* [left=\bf{Tau}]{
	  }{
	    \tau.P \stackrel{\tau}{\longmapsto} P
	  }$
      \\\\
	  $\inferrule* [left=\bf{StarInp}]{
	      S \stackrel{xy}{\longmapsto} S^{'}
	  }{
	      *S \stackrel{xy}{\longmapsto} S^{'}
	  }$
	  &
	  $\inferrule* [left=\bf{SInpLow}]{
%	      y\notin fn(P)-\{z\}
	  }{
	    \underline{x(z)}.P \stackrel{xy}{\longmapsto} * P\{y/z\}
	  }$
	  &
	  $\inferrule* [left=\bf{Sum}]{
	    P \stackrel{\gamma}{\longmapsto} S
	  }{
	    P+Q \stackrel{\gamma}{\longmapsto} S
	  }$
      \\\\
	  $\inferrule* [left=\bf{StarEps}]{
	      S \stackrel{\epsilon}{\longmapsto} S^{'}
	  }{
	      *S \stackrel{\epsilon}{\longmapsto} S^{'}
	  }$
	  &
	  &
      \\\\
      \end{tabular}
      \begin{tabular}{lll}
      \\\\
	  $\inferrule* [left=\bf{Com1}]{
	      P \stackrel{\overline{x}y}{\longmapsto} P^{'}
	    \\
	      Q \stackrel{xy}{\longmapsto} Q^{'}
	  }{
	    P|Q \stackrel{\tau}{\longmapsto} P^{'}|Q^{'}
	  }$
	  &
	  &
      \\\\
	  $\inferrule* [left=\bf{Com2L}]{
	      L_{1} \stackrel{xy}{\longmapsto} L_{2}
	    \\
	      P \stackrel{\overline{x}y}{\longmapsto} Q
	  }{
	    L_{1}|P \stackrel{\epsilon}{\longmapsto} L_{2}|Q
	  }$
	&
	  $\inferrule* [left=\bf{Com2R}]{
	      P \stackrel{\overline{x}y}{\longmapsto} Q
	    \\
	      L_{1} \stackrel{xy}{\longmapsto} L_{2}
	  }{
	    P|L_{1} \stackrel{\epsilon}{\longmapsto} Q|L_{2}
	  }$
	  &
      \\\\
	  $\inferrule* [left=\bf{Com3L}]{
	      P \stackrel{xy}{\longmapsto} L
	    \\
	      Q \stackrel{\overline{x}y}{\longmapsto} Q^{'}
	  }{
	    P|Q \stackrel{\epsilon}{\longmapsto} L|Q^{'}
	  }$
	&
	  $\inferrule* [left=\bf{Com3R}]{
	      Q \stackrel{\overline{x}y}{\longmapsto} Q^{'}	      
	    \\
	      P \stackrel{xy}{\longmapsto} L
	  }{
	    Q|P \stackrel{\epsilon}{\longmapsto} Q^{'}|L
	  }$
	  &
      \\\\
	  $\inferrule* [left=\bf{Com4L}]{
	      L \stackrel{xy}{\longmapsto} P
	    \\
	      Q \stackrel{\overline{x}y}{\longmapsto} Q^{'}
	  }{
	    L|Q \stackrel{\tau}{\longmapsto} P|Q^{'}
	  }$
	  &
	  $\inferrule* [left=\bf{Com4R}]{
	      Q \stackrel{\overline{x}y}{\longmapsto} Q^{'}
	    \\
	      L \stackrel{xy}{\longmapsto} P
	  }{
	    L|Q \stackrel{\tau}{\longmapsto} P|Q^{'}
	  }$
	  &
      \\\\
      \end{tabular}
      \begin{tabular}{lll}
      \\\\
	  $\inferrule* [left=\bf{Res}]{
	      S \stackrel{\gamma}{\longmapsto} S^{'}
	    \\
	      y\notin n(\gamma)
	  }{
	    (\nu y) S \stackrel{\gamma}{\longmapsto} (\nu y) S^{'}
	  }$
	  &
	  $\inferrule* [left=\bf{Opn}]{
	      P \stackrel{\overline{x}y}{\longmapsto} Q
	    \\ 
	      y\neq x
	  }{
	      (\nu y)P \stackrel{\overline{x}(y)}{\longmapsto} Q
	  }$
	  &
	  $\inferrule* [left=\bf{Cong}]{
	      P\equiv P^{'}
	    \\
	      P^{'} \stackrel{\gamma}{\longmapsto} S
	  }{
	      P \stackrel{\gamma}{\longmapsto} S
	  }$
      \\\\
      \end{tabular}
      \begin{tabular}{lll}
      \\\\
	  $\inferrule* [left=\bf{Par1L}]{
	      S \stackrel{\gamma}{\longmapsto} S^{'}
% 	    \\ 
% 	      bn(\gamma)\cap fn(Q)=\emptyset
	  }{
	      S|Q \stackrel{\gamma}{\longmapsto} S^{'}|Q
	  }$
	&
	  $\inferrule* [left=\bf{Par1R}]{
	      S \stackrel{\gamma}{\longmapsto} S^{'}
% 	    \\ 
% 	      bn(\gamma)\cap fn(Q)=\emptyset
	  }{
	      Q|S \stackrel{\gamma}{\longmapsto} Q|S^{'}
	  }$
	  &
      \\\\\hline
    \end{tabular}
    \caption{Low multi $\pi$ early semantic with structural congruence}
    \label{lowleveltransitionrelationinput}
  \end{table}
\end{definition}



\begin{lemma}\label{lemmacom3}
  For all unmarked processes $P,Q$ and marked processes $L_{1}, L_{2}$.
  \begin{itemize}
    \item
      if $P\stackrel{\alpha}{\longmapsto}L_{1}$ or $L_{1}\stackrel{\alpha}{\longmapsto}L_{2}$ then $\alpha$ can only be an input or an $\epsilon$
    \item
      if $L_{1}\stackrel{\alpha}{\longmapsto}P$ then $\alpha$ is an input or a $\tau$
    \item
      if $P\stackrel{\alpha}{\longmapsto}Q$ then $\alpha$ is not an $\epsilon$
  \end{itemize}
  \begin{proof}
    DA FARE
  \end{proof}
\end{lemma}


  
\begin{definition}\label{low}
  Let $P, Q$ be unmarked processes and $L_{1}, \cdots, L_{k-1}$ marked processes. We define the derivation relation $\rightarrow_{s}$ in the following way:
  \begin{center}
    $\inferrule* [left=\bf{Low}]{
	P \stackrel{\gamma_{1}}{\longmapsto} L_{1} \stackrel{\gamma_{2}}{\longmapsto} L_{2} \cdots L_{k-1} \stackrel{\gamma_{k}}{\longmapsto} Q
      \\
	k\geq 1
    }{
      P \xrightarrow{\gamma_{1} \cdots \gamma_{k}}_{s}  Q
    }$
  \end{center}
  We need to be precise about the concatenation operator $\cdot$ since we have introduced the new label $\epsilon$. Let $a$ be an action such that $a\neq \tau$ and $a\neq \epsilon$ then the following rules hold:
  \begin{center}
      \begin{tabular}{lll}
	  $\epsilon \cdot a = a \cdot \epsilon = a$
	&
	  $\epsilon \cdot \epsilon = \epsilon$
	&
	  $\tau \cdot \epsilon = \epsilon \cdot \tau = \tau$
	\\
	  $\tau \cdot a = a \cdot \tau = a$
	&
	  $\tau \cdot \tau = \tau$
	&
      \end{tabular}
  \end{center}
\end{definition}

\begin{example}Multi-party synchronization
  We show an example of a derivation of three processes that synchronize.
 
  \begin{center}$
    \inferrule* [left=\bf{Par1L}]{
      \inferrule* [left=\bf{Com3}]{
	\inferrule* [left=\bf{SInpLow}]{
	}{
	  \underline{x(a)}.x(b).P
	    \stackrel{xy}{\longmapsto}
	      *(x(b).P\{y/a\})
	}
      \\
	\inferrule* [left=\bf{Out}]{
	}{
	  \overline{x}y.Q \stackrel{\overline{x}y}{\longmapsto} Q
	}
      }{
	\underline{x(a)}.x(b).P|\overline{x}y.Q
	  \stackrel{\epsilon}{\longmapsto}
	    *(x(b).P\{y/a\})|Q
      }
  }{
	(\underline{x(a)}.x(b).P|\overline{x}y.Q) | \overline{x}z.R
	  \stackrel{\epsilon}{\longmapsto}
	    (*(x(b).P\{y/a\})|Q)|\overline{x}z.R
  }
  $\end{center}

  \begin{center}$
    \inferrule* [left=\bf{Par1}]{
      \inferrule*[left=\bf{Star}]{
	\inferrule* [left=\bf{EInp}]{
	}{
	  x(b).P\{y/a\} \stackrel{xz}{\longmapsto} P\{y/a\}\{z/b\}
	}
      }{
	*(x(b).P\{y/a\}) \stackrel{xz}{\longmapsto} P\{y/a\}\{z/b\}      
      }
    }{
      *(x(b).P\{y/a\}) | Q \stackrel{xz}{\longmapsto} P\{y/a\}\{z/b\} | Q
    }
  $\end{center}

  \begin{center}$
    \inferrule* [left=\bf{Com4}]{
      *(x(b).P\{y/a\}) | Q \stackrel{xz}{\longmapsto} P\{y/a\}\{z/b\} | Q
    \\
      \inferrule* [left=\bf{Out}]{
      }{
	\overline{x}z.R	
	  \stackrel{\overline{x}z}{\longmapsto}
	    R
      }
    }{
	(\underline{x(a)}.x(b).P|\overline{x}y.Q)|\overline{x}z.R
	  \stackrel{\tau}{\longmapsto}
	    (P\{y/a\}\{z/b\}|Q)|R
    }
  $\end{center}

  \begin{center}
  $
      \inferrule* [left=\bf{Low}]{
	(\underline{x(a)}.x(b).P|\overline{x}y.Q) | \overline{x}z.R
	  \stackrel{\epsilon}{\longmapsto}
	    (*(x(b).P\{y/a\})|Q)|\overline{x}z.R
	      \xrightarrow{\tau}
		(P\{y/a\}\{z/b\}|Q)|R
      }{
	(\underline{x(a)}.x(b).P|\overline{x}y.Q)|\overline{x}z.R
	  \xrightarrow{\tau}_{s}
	    (P\{y/a\}\{z/b\}|Q)|R
      }
  $
  \end{center}

\end{example}










\begin{proposition}\label{equivalencehightolowinput}
  Let $\rightarrow$ be the relation defined in table \ref{multipisoloinputearlywith}. If $P\xrightarrow{\sigma} Q$ then there exist $L_{1}, \cdots, L_{k}$ and $\gamma_{1}, \cdots, \gamma_{k+1}$ with $k\geq 0$ such that 
  \begin{center}
    \begin{tabular}{lll}
      $P \stackrel{\gamma_{1}}{\longmapsto} L_{1}  \stackrel{\gamma_{2}}{\longmapsto} L_{2} \cdots L_{k-1} \stackrel{\gamma_{k}}{\longmapsto} L_{k} \stackrel{\gamma_{k+1}}{\longmapsto} Q$ 
    &
      and
    &
      $\gamma_{1} \cdot \ldots \cdot \gamma_{k+1} = \sigma$  
    \end{tabular}
  \end{center}
  \begin{proof}
    The proof is by induction on the depth of the derivation tree of $P\xrightarrow{\sigma} Q$:
    \begin{description}
      \item[base case]
    \end{description}
	If the depth is one then the rule used have to be one of: $EInp$, $Out$, $Tau$. These rules are also in table \ref{lowleveltransitionrelationinput} so we can derive $P \stackrel{\sigma}{\longmapsto}Q$.
    \begin{description}
      \item[inductive case]
    \end{description}
	If the depth is greater than one then the last rule used in the derivation can be:
	\begin{description}
	  \item[$SInpSeq$]: 
	    the last part of the derivation tree looks like this:
	    \begin{center}
	      $\inferrule* [left=\bf{SInpSeq}]{
		  P_{1} \xrightarrow{\sigma} Q
		\\
		  |\sigma|>1
	      }{
		\underline{x(y)}.P_{1} \xrightarrow{xy \cdot \sigma} Q
	      }$	      
	    \end{center}
	    for inductive hypothesis there exist $L_{1}, \cdots, L_{k}$ and $\gamma_{1}, \cdots, \gamma_{k+1}$ with $k\geq 0$ such that 
	    \begin{center}
	      \begin{tabular}{lll}
		$P_{1} \stackrel{\gamma_{1}}{\longmapsto} L_{1} \stackrel{\gamma_{2}}{\longmapsto} L_{2} \cdots L_{k-1} \stackrel{\gamma_{k}}{\longmapsto} L_{k} \stackrel{\gamma_{k+1}}{\longmapsto} Q$ 
	      &
		and
	      &
		$\gamma_{1} \cdot \ldots \cdot \gamma_{k+1} = \sigma$
	      \end{tabular}
	    \end{center}
	    then a proof of the conclusion follows from:
	    \begin{center}
	      \begin{tabular}{ll}
		$\inferrule* [left=\bf{SInpLow}]{
 		}{
 		  \underline{x(y)}.P_{1} \stackrel{xy}{\longmapsto} *P_{1}
 		}$
	      &
		$\inferrule* [left=\bf{Star}]{
 		  P_{1} \stackrel{\gamma_{1}}{\longmapsto} L_{1}
 		}{
 		  *P_{1} \stackrel{\gamma_{1}}{\longmapsto} L_{1}
 		}$
	      \end{tabular}
	    \end{center}
	    where $Star$ means $StarInp$ or $StarEps$, note that $\gamma_{1}$ is an input or an $epsilon$ because of \ref{lemmastrongsequence}.
	  \item[$SInp$]: this case is similar to the previous.
	  \item[$SInpTau$]: this case is similar to the previous observing that $xy \cdot \tau = xy$.
	  \item[$Sum$]: 
	the last part of the derivation tree looks like this:
	\begin{center}
	  $\inferrule* [left=\bf{Sum}]{
	    P_{1} \xrightarrow{\sigma} Q
	  }{
	    P_{1}+P_{2} \xrightarrow{\sigma} Q
	  }$
	\end{center}
	for the inductive hypothesis there exist $L_{1}$, $\cdots$, $L_{k}$ and $\gamma_{1}$, $\cdots$, $\gamma_{k+1}$ with $k\geq 0$ such that 
	\begin{center}
	  \begin{tabular}{lll}
	    $P_{1} \stackrel{\gamma_{1}}{\longmapsto} L_{1}  \stackrel{\gamma_{2}}{\longmapsto} L_{2} \cdots L_{k-1} \stackrel{\gamma_{k}}{\longmapsto} L_{k} \stackrel{\gamma_{k+1}}{\longmapsto} Q$ 
	  &
	    and
	  &
	    $\gamma_{1} \cdot \ldots \cdot \gamma_{k+1} = \sigma$  
	  \end{tabular}
	\end{center}
	A proof of the conclusion is:
	\begin{center}
	  $\inferrule* [left=\bf{Sum}]{
	      P_{1} \stackrel{\gamma_{1}}{\longmapsto} L_{1}
	    }{
	      P_{1}+P_{2} \stackrel{\gamma_{1}}{\longmapsto} L_{1}
	    }
	  $
	\end{center}
      \item[$Cong$]: this case is similar to the previous.
      \item[$ECom$]: 
	the last part of the derivation tree looks like this:
	\begin{center}
	  $\inferrule* [left=\bf{Com}]{
	      P_{1} \xrightarrow{xy} P_{1}^{'}
	    \\
	      Q_{1} \xrightarrow{\overline{x}y} Q_{1}^{'}
	  }{
	    P_{1}|Q_{1} \xrightarrow{\tau} P_{1}^{'}|Q_{1}^{'}
	  }$
	\end{center}
	for inductive hypothesis there exist $L_{1}, \cdots, L_{k}$ and $\gamma_{1}, \cdots, \gamma_{k+1}$ with $k\geq 0$ such that 
	\begin{center}
	  \begin{tabular}{lll}
	    $P_{1} \stackrel{\gamma_{1}}{\longmapsto} L_{1}  \stackrel{\gamma_{2}}{\longmapsto} L_{2} \cdots L_{k-1} \stackrel{\gamma_{k}}{\longmapsto} L_{k} \stackrel{\gamma_{k+1}}{\longmapsto} P_{1}^{'}$ 
	  &
	    and
	  &
	    $\gamma_{1} \cdot \ldots \cdot \gamma_{k+1} = xy$
	  \end{tabular}
	\end{center}
	and there exist $R_{1}, \cdots, R_{h}$ and $\delta_{1}, \cdots, \delta_{h+1}$ with $h\geq 0$ such that 
	\begin{center}
	  \begin{tabular}{lll}
	    $Q_{1} \stackrel{\delta_{1}}{\longmapsto} R_{1}  \stackrel{\delta_{2}}{\longmapsto} R_{2} \cdots R_{h-1} \stackrel{\delta_{h}}{\longmapsto} R_{h} \stackrel{\delta_{h+1}}{\longmapsto} Q_{1}^{'}$ 
	  &
	    and
	  &
	    $\delta_{1} \cdot \ldots \cdot \delta_{h+1} = \overline{x}y$
	  \end{tabular}
	\end{center}
	For lemma \ref{lemmacom3} there cannot be an output action in a transition involving marked processes so $h$ must be $0$ and $Q_{1} \stackrel{\delta_{1}}{\longmapsto} Q_{1}^{'}$ with $\delta_{1}=\overline{x}y$. We can have three different cases now: 
	\begin{description}
	  \item[$\gamma_{1}=xy$]:
	    A proof of the conclusion is:
	    \begin{center}
	      $P_{1}|Q_{1} \stackrel{\tau}{\longmapsto} L_{1}|Q_{1}^{'}
			      \stackrel{\epsilon}{\longmapsto} L_{2}|Q_{1}^{'}
		  \cdots
				\stackrel{\epsilon}{\longmapsto} L_{k}|Q_{1}^{'}
				\stackrel{\epsilon}{\longmapsto} P_{1}^{'}|Q_{1}^{'}$	  
	    \end{center}
	    we derive the first transition with rule $Com3L$, whether for the other transition we use the rule $Par1L$.
	  \item[$\gamma_{i}=xy$]:
	    A proof of the conclusion is:
	    \begin{center}
	      $
		  P_{1}|Q_{1} \stackrel{\epsilon}{\longmapsto} L_{1}|Q_{1} 
		  \cdots
			      \stackrel{\epsilon}{\longmapsto} L_{i-1}|Q_{1} 
			      \stackrel{\tau}{\longmapsto} L_{i}|Q_{1}^{'}
			      \stackrel{\epsilon}{\longmapsto} L_{i+1}|Q_{1}^{'}
		  \cdots 
			      \stackrel{\epsilon}{\longmapsto} L_{k}|Q_{1}^{'}
			      \stackrel{\epsilon}{\longmapsto} P_{1}^{'}|Q_{1}^{'}$	  
	    \end{center}
	    we derive the transaction $ L_{i-1}|Q_{1} \stackrel{\tau}{\longmapsto} L_{i}|Q_{1}^{'}$ with rule $Com2L$, whether for the other transactions  we use the rule $Par1L$.
	  \item[$\gamma_{k+1}=xy$] similar.
	\end{description}
      \item[$Res$]: 
	the last part of the derivation tree looks like this:
	\begin{center}
	  $\inferrule* [left=\bf{Res}]{
	      P_{1} \xrightarrow{\sigma} Q_{1}
	    \\
	      z\notin n(\sigma)
	  }{
	    (\nu z) P_{1} \xrightarrow{\sigma} (\nu z) Q_{1}
	  }$
	\end{center}
	for the inductive hypothesis there exist $L_{1}, \cdots, L_{k}$ and $\gamma_{1}, \cdots, \gamma_{k+1}$ with $k\geq 0$ such that 
	\begin{center}
	  \begin{tabular}{lll}
	    $P_{1} \stackrel{\gamma_{1}}{\longmapsto} L_{1}  \stackrel{\gamma_{2}}{\longmapsto} L_{2} \cdots L_{k-1} \stackrel{\gamma_{k}}{\longmapsto} L_{k} \stackrel{\gamma_{k+1}}{\longmapsto} Q_{1}$ 
	  &
	    and
	  &
	    $\gamma_{1} \cdot \ldots \cdot \gamma_{k+1} =  \sigma$
	  \end{tabular}
	\end{center}
	We can apply the rule $Res$ to each of the previous transitions because 
	\begin{center}
	  $z\notin n(\sigma)$ implies $z\notin n(\gamma_{i})$ for each $i$
	\end{center}
	and then get a proof of the conclusion:
	\begin{center}
	  $(\nu z)P_{1} \stackrel{\gamma_{1}}{\longmapsto} (\nu z)L_{1}  \stackrel{\gamma_{2}}{\longmapsto} (\nu z)L_{2} \cdots (\nu z)L_{k-1} \stackrel{\gamma_{k}}{\longmapsto} (\nu z)L_{k} \stackrel{\gamma_{k+1}}{\longmapsto} (\nu z)Q_{1}$
	\end{center}
      \item[$Par$]: this case is similar to the previous.
      \item[$EComSeq$]: 
	the last part of the derivation tree looks like this:
	\begin{center}
	  $\inferrule* [left=\bf{EComSeq}]{
	      P_{1} \xrightarrow{xy \cdot \sigma} P_{1}^{'}
	    \\
	      Q_{1} \xrightarrow{\overline{x}y} Q_{1}^{'}
	  }{
	    P_{1}|Q_{1} \xrightarrow{\sigma} P_{1}^{'}|Q_{1}^{'}
	  }$
	\end{center}
	for inductive hypothesis there exist $L_{1}$, $\cdots$, $L_{k}$ and $\gamma_{1}$, $\cdots$, $\gamma_{k+1}$ with $k\geq 0$ such that 
	\begin{center}
	  \begin{tabular}{lll}
	    $P_{1} \stackrel{\gamma_{1}}{\longmapsto} L_{1}  \stackrel{\gamma_{2}}{\longmapsto} L_{2} \cdots L_{k-1} \stackrel{\gamma_{k}}{\longmapsto} L_{k} \stackrel{\gamma_{k+1}}{\longmapsto} P_{1}^{'}$ 
	  &
	    and
	  &
	    $\gamma_{1} \cdot \ldots \cdot \gamma_{k+1} = xy \cdot \sigma$  
	  \end{tabular}
	\end{center}
	For inductive hypothesis and lemma \ref{multioutconstraintswithmarked} $Q_{1} \stackrel{\overline{x}y}{\longmapsto} Q_{1}^{'}$. We can have two different cases now depending on where the first $xy$ is:
	\begin{description}
	  \item[$\gamma_{1}=xy$]:
	    A proof of the conclusion is:
	    \begin{center}
	      $P_{1}|Q_{1} \stackrel{\tau}{\longmapsto} L_{1}|Q_{1}^{'}
			      \stackrel{\gamma_{2}}{\longmapsto} L_{2}|Q_{1}^{'}
		  \cdots
			      \stackrel{\gamma_{k}}{\longmapsto} L_{k}|Q_{1}^{'}
			      \stackrel{\gamma_{k+1}}{\longmapsto} P_{1}^{'}|Q_{1}^{'}$	  
	    \end{center}
	    we derive the first transition with rule $Com3L$, whether for the other transactions we use the rule $Par1L$. Since $\gamma_{1} \cdot \ldots \cdot \gamma_{k+1} = xy \cdot \sigma$ and $\gamma_{1}=xy$ then $\tau \cdot \gamma_{2}\cdot \ldots \cdot \gamma_{k+1}\cdot \epsilon \cdot \ldots \epsilon \cdot \tau=\sigma$
	  \item[$\gamma_{i}=xy$]:
	    A proof of the conclusion is:
	    \begin{center}
	      $P_{1}|Q_{1} \stackrel{\epsilon}{\longmapsto} L_{1}|Q_{1} 
		  \cdots
			      \stackrel{\epsilon}{\longmapsto} L_{i-1}|Q_{1} 
			      \stackrel{\tau}{\longmapsto} L_{i}|Q_{1}^{'}
			      \stackrel{\gamma_{i+1}}{\longmapsto} L_{i+1}|Q_{1}^{'}
		  \cdots 
			      \stackrel{\gamma_{k}}{\longmapsto} L_{k}|Q_{1}^{'}
			      \stackrel{\gamma_{k+1}}{\longmapsto} P_{1}^{'}|Q_{1}^{'}$	  
	    \end{center}
	    we derive the transition $ L_{i-1}|Q_{1} \stackrel{\tau}{\longmapsto} L_{i}|Q_{1}^{'}$ with rule $Com2L$, whether for the other transactions of the premises we use the rule $Par1L$.
	  \item[$\gamma_{k+1}=xy$]: cannot happen because $\sigma$ is not empty.
	\end{description}
    \end{description}
  \end{proof}
\end{proposition}






\begin{proposition}
  Let $\rightarrow$ be the relation defined in table \ref{multipisoloinputearlywith}. Let $\alpha$ be an action. If $P \stackrel{\alpha}{\longmapsto} Q$ then $P\xrightarrow{\alpha} Q$.
  \begin{proof}
    The proof is by induction the depth of the derivation of $P \stackrel{\alpha}{\longmapsto} Q$:
    \begin{description}
      \item[base case]
	in this case the derivation of this transition has depth one. The last(and only) rule used can be: $Out$, $EInp$ or $Tau$; these rules are also in table \ref{multipisoloinputearlywith} so we can derive $P\xrightarrow{\alpha} Q$. 
      \item[inductive case]
	in this case the last rule in the derivation can be: $Sum$, $Com1$, $Res$, $Par1L$, $Par1R$, $Cong$, $Opn$:
	\begin{description}
	  \item[$Com1$]:
	    \begin{center}
	      $\inferrule* [left=\bf{Com1}]{
		  P_{1} \stackrel{xy}{\longmapsto} Q_{1}
		\\
		  P_{2} \stackrel{\overline{x}y}{\longmapsto} Q_{2}
	      }{
		P_{1}|P_{2} \stackrel{\tau}{\longmapsto} Q_{1}|Q_{2}
	      }$ 
	    \end{center}
	    for inductive hypothesis $P_{1} \xrightarrow{xy} Q_{1}$ and $P_{2} \xrightarrow{\overline{x}y} Q_{2}$ so for rule $Com$ $P_{1}|P_{2} \xrightarrow{\tau} Q_{1}|Q_{2}$
	  \item[$Sum$]:
	    \begin{center}
	      $\inferrule* [left=\bf{Sum}]{
		P_{1} \stackrel{\alpha}{\longmapsto} Q
	      }{
		P_{1}+P_{2} \stackrel{\alpha}{\longmapsto} Q
	      }$ 
	    \end{center}
	    for inductive hypothesis $P_{1} \xrightarrow{\alpha} Q$ and for rule $Sum$ $P_{1}+P_{2} \xrightarrow{\alpha} Q$.
	  \item[$Res$] the first transition is:
	    \begin{center}
	      $\inferrule* [left=\bf{Res}]{
		  P_{1} \stackrel{\alpha}{\longmapsto} Q_{1}
		\\
		  z\notin n(\gamma_{1})
	      }{
		(\nu z) P_{1} \stackrel{\alpha}{\longmapsto} (\nu z)Q_{1}
	      }$ 
	    \end{center}		
	    for inductive hypothesis $P_{1} \xrightarrow{\alpha} Q_{1}$ and for rule $Res$ $(\nu z)P_{1} \xrightarrow{\alpha} (\nu z)Q_{1}$.
	 \item[$others$]: other cases are similar.
      \end{description}	    
    \end{description}	    
  \end{proof}
\end{proposition}



\subsection{Late operational semantic without structural congruence}

DA FARE

\begin{definition}
  The \emph{late transition relation without structural congruence} is the smallest relation induced by the rules in table \ref{multipisoloinputlateywith}.
  \begin{table}
    \begin{tabular}{ll}
	\hline\\
     	  $\inferrule* [left=\bf{Pref}]{
	    \alpha not a strong prefix
	  }{
	    \alpha.P \xrightarrow{\alpha} P
	  }$
	&
	  $\inferrule* [left=\bf{LComSeq}]{
	      P \xrightarrow{x(y)\cdot \sigma} P^{'}
	    \\
	      Q\xrightarrow{\overline{x}z} Q^{'}
	    \\
	      z\notin fn(\sigma)\cup fn(P)
	  }{
	    P|Q \xrightarrow{\sigma\{z/y\}} P^{'}\{z/y\}|Q^{'}
	  }$
      \\\\
	  $\inferrule* [left=\bf{SInp}]{
	      P \xrightarrow{a(b)} P^{'}
	  }{
	    \underline{x(y)}.P \xrightarrow{x(y) \cdot a(b)} P^{'}
	  }$
	&
	  $\inferrule* [left=\bf{LCom}]{
	      P \xrightarrow{x(y)} P^{'}
	    \\
	      Q\xrightarrow{\overline{x}z} Q^{'}
	    \\
	      z\notin fn(P)
	  }{
	    P|Q \xrightarrow{\tau} P^{'}\{z/y\}|Q^{'}
	  }$
      \\\\
	  $\inferrule* [left=\bf{Sum}]{
	    P \xrightarrow{\sigma} P^{'}
	  }{
	    P+Q \xrightarrow{\sigma} P^{'}
	  }$
	&
	  $\inferrule* [left=\bf{Cong}]{
	      P\equiv P^{'}
	    \\
	      P^{'} \xrightarrow{\sigma} Q
	  }{
	      P \xrightarrow{\sigma} Q
	  }$
      \\\\
	  $\inferrule* [left=\bf{Res}]{
	      P \xrightarrow{\sigma} P^{'}
	    \\
	      z\notin n(\alpha)
	  }{
	    (\nu z) P \xrightarrow{\sigma} (\nu z) P^{'}
	  }$
	&
	  $\inferrule* [left=\bf{Par}]{
	      P \xrightarrow{\sigma} P^{'}
	    \\
	      bn(\sigma)\cup fn(Q)=\emptyset
	  }{
	    P|Q \xrightarrow{\sigma} P^{'}|Q
	  }$
      \\\\
	  $\inferrule* [left=\bf{Opn}]{
	      P \xrightarrow{\overline{x}z} P^{'}
	    \\ 
	      z\neq x
	  }{
	      (\nu z)P \xrightarrow{\overline{x}(z)} P^{'}
	  }$
	&
	  $\inferrule* [left=\bf{SInpSeq}]{
	      P \xrightarrow{\sigma} P^{'}
	    \\
	      |\sigma|>1
	  }{
	    \underline{x(y)}.P \xrightarrow{x(y) \cdot \sigma} P^{'}
	  }$
      \\\\
	  $\inferrule* [left=\bf{SInpTau}]{
	      P \xrightarrow{\tau} P^{'}
	  }{
	    \underline{x(y)}.P \xrightarrow{x(y)} P^{'}
	  }$
	&
      \\\hline
    \end{tabular}
    \caption{Multi $\pi$ late semantic with structural congruence}
    \label{multipisoloinputlateywith}
  \end{table}
\end{definition}

\begin{example}Multi-party synchronization
  We show an example of a derivation of three processes that synchronize with the late semantic. The three processes are $\underline{x(a)}.x(b).P$, $\overline{x}y.Q$ and $\overline{x}z.R$. We assume that:
  \begin{center}
      $a\notin fn(x(b))\cup fn (\underline{x(a)}.x(b).P)$
  \end{center}
  and
  \begin{center}
      $b\notin fn(\underline{x(a)}.x(b).P|\overline{x}y.Q)$
  \end{center}

  \begin{center}
  $
      \inferrule* [left=\bf{LCom}]{
	\underline{x(a)}.x(b).P|\overline{x}y.Q
	  \xrightarrow{x(b)}
	    P\{y/a\}|Q
	\\
	  \inferrule* [left=\bf{Pref}]{
	  }{
	    \overline{x}z.R	
	      \xrightarrow{\overline{x}z} 
		R
	  }
      }{
	(\underline{x(a)}.x(b).P|\overline{x}y.Q)|\overline{x}z.R
	  \xrightarrow{\tau}
	    (P\{y/a\}|Q)\{z/b\}|R
      }
  $
  \end{center}
  
  \begin{center}
  $\inferrule* [left=\bf{LComSeq}]{
      \inferrule* [left=\bf{SInp}]{
	\inferrule* [left=\bf{Pref}]{
	}{
	  x(b).P \xrightarrow{x(b)} P
	}
      }{
	\underline{x(a)}.x(b).P
	  \xrightarrow{x(a) \cdot x(b)} 
	    P
      }
    \\
      \inferrule* [left=\bf{Out}]{
      }{
	\overline{x}y.Q \xrightarrow{\overline{x}y} Q
      }
  }{
	\underline{x(a)}.x(b).P|\overline{x}y.Q)
	  \xrightarrow{x(b)}
	    P\{y/a\}|Q
  }$
  \end{center}

\end{example}
